<!DOCTYPE html>




<html class="theme-next muse" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">
<meta name="google-site-verification" content="gVkxHuty-Yq4pXCYdtF18vY2y64Ez3dl8mbUHcC0Uys" />
<meta name="baidu-site-verification" content="gccGr7k9sM" />

  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">




  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="fdzt5cwPb3ZyCXTx-RDybhtFGGVcsFgBiCWn7xWrOzU" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=-apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;:300,300italic,400,400italic,700,700italic|-apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;:300,300italic,400,400italic,700,700italic|-apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;:300,300italic,400,400italic,700,700italic|-apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;:300,300italic,400,400italic,700,700italic|Menlo,Monaco,Consolas,"Andale Mono","lucida console","Courier New",monospace;:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/favicon.png?v=5.1.4" color="#222">





  <meta name="keywords" content="Python, C, PAT, Hexo" />










<meta name="description" content="Computer System: A Programming Perspective                       /* @licstart  The following is the entire license notice for the JavaScript code in this tag.  Copyright (C) 2012-2018 Free Soft">
<meta name="keywords" content="Python|DL|C|PAT|OBJC|EMACS|ORG">
<meta property="og:type" content="website">
<meta property="og:title" content="Mengoreo">
<meta property="og:url" content="https://mengoreo.github.io/emacs-blog/Fundamental/Computer_System.html">
<meta property="og:site_name" content="Mengoreo">
<meta property="og:description" content="Computer System: A Programming Perspective                       /* @licstart  The following is the entire license notice for the JavaScript code in this tag.  Copyright (C) 2012-2018 Free Soft">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://juicyiter.gitee.io/images/compile-system.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/os-hierarchy.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/virtual-space.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/abstractions-of-computer.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/sizes-of-data-types.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/bi-endian.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/tmin-test.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/data-orders.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/unsigned-addition.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/unsigned-negation.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/two-s-complement-addition.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/two-s-complement-negation.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/fractional-binary-number.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/approximated-number.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/IEEE-floating-point-representation.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/ia32-integer-registers.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/sizes-of-c-data-types-in-ia32.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/ia32-integer-registers.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/operand-forms.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/data-movement-instructions.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/illustration-of-stack-operation.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/integer-arithmetic-operations.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/special-arithmetic-operations.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/comparison-and-test-instructions.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/the-set-instructions.png">
<meta property="og:image" content="https://juicyiter.gitee.io/imgaes/the-jump-instructions.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/the-conditional-move-instructions.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/sample-code-table.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/stack-frame-structure.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/illustration-of-call-and-ret-functions.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/stack-frame-for-caller-and-swap-add.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/struct-and-union-alignment.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/stack-organization.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/stack-corruption-detection.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/64-bit-integer-registers.png">
<meta property="og:image" content="https://juicyiter.gitee.io/images/64-bit-data-movement-instructions.png">
<meta property="og:image" content="http://juicyiter.gitee.io/images/64-bit-special-arithmetic-operations.png">
<meta property="og:updated_time" content="2019-04-08T05:39:01.025Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mengoreo">
<meta name="twitter:description" content="Computer System: A Programming Perspective                       /* @licstart  The following is the entire license notice for the JavaScript code in this tag.  Copyright (C) 2012-2018 Free Soft">
<meta name="twitter:image" content="https://juicyiter.gitee.io/images/compile-system.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"right","display":"hide","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"Can't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://mengoreo.github.io/emacs-blog/Fundamental/Computer_System.html"/>





  <title> | Mengoreo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    
      <div class="site-meta-headline">
        <a>
          <img class="custom-logo-image" src="/images/headavatar.png"
               alt="Mengoreo"/>
        </a>
      </div>
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mengoreo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Be yourself & Beyond yourself</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-voices">
          <a href="/voices/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-microphone"></i> <br />
            
            My Voice
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.1/katex.min.css" type="text/css">
 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline"></h1>



</header>

      
      
      
      <div class="post-body han-init-context">
        
        
          <?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-04-08 Mon 13:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Computer System: A Programming Perspective</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Ethan Mengoreo">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="icon" sizes="180x180" href="https://juicyiter.gitee.io/images/favicon.png?v=5.1.4">
<link rel="icon" sizes="32x32" href="https://juicyiter.gitee.io/images/favicon32.png?v=5.1.4">
<link rel="icon" sizes="16x16" href="https://juicyiter.gitee.io/images/favicon16.png?v=5.1.4">
<link rel="mask-icon" href="https://juicyiter.gitee.io/images/favicon.png?v=5.1.4" color="#222">
<link rel="stylesheet" type="text/css" href="https://juicyiter.gitee.io/assets/css/htmlize.css">
<link rel="stylesheet" type="text/css" href="https://juicyiter.gitee.io/assets/css/readtheorg.css">
<link rel="stylesheet" type="text/css" href="https://juicyiter.gitee.io/assets/css/rtd-full.css">
<link rel="stylesheet" type="text/css" href="https://juicyiter.gitee.io/assets/css/emphasis.css">
<link rel="stylesheet" type="text/css" href="https://juicyiter.gitee.io/assets/css/mengoreo.css">
<script type="text/javascript" src="https://juicyiter.gitee.io/assets/js/jquery-2.1.3.min.js"></script>
<script type="text/javascript" src="https://juicyiter.gitee.io/assets/js/bootstrap-3.3.4.min.js"></script>
<script type="text/javascript" src="https://juicyiter.gitee.io/assets/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://juicyiter.gitee.io/assets/js/readtheorg.js"></script>
<script type="text/javascript" src="https://juicyiter.gitee.io/assets/js/mengoreo.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_SVG"></script>
<script type="text/x-mathjax-config;executed=true">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        jax: ["input/TeX", "output/SVG"],

        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": {
             scale: 100,
             linebreaks: { automatic: "false" },
             webFont: "TeX"
        },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Computer System: A Programming Perspective</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org40301da">1. A tour</a></li>
<li><a href="#orge4eb835">2. Representing and Manipulating Information</a>
<ul>
<li><a href="#org1839ff5">2.1. Information Storage</a></li>
<li><a href="#org470f386">2.2. Integer Representations</a></li>
<li><a href="#org7e52d48">2.3. Integer Arithmetic</a>
<ul>
<li><a href="#orgf0bb3bf">2.3.1. Unsigned Addition</a></li>
<li><a href="#org216999c">2.3.2. Unsigned Negation</a></li>
<li><a href="#org54c1d8b">2.3.3. Unsigned Multiplication</a></li>
<li><a href="#org7c746d8">2.3.4. Two's Complement Additon</a></li>
<li><a href="#org93ec3d0">2.3.5. Two's Complement Negation</a></li>
<li><a href="#org84cefe0">2.3.6. Two's Complement Multiplication</a></li>
<li><a href="#org93e7a1a">2.3.7. Multiplying by Constants</a></li>
<li><a href="#org079f43f">2.3.8. Dividing by Powers of Two</a></li>
<li><a href="#org7d7ce56">2.3.9. Summary</a></li>
</ul>
</li>
<li><a href="#org10c36d6">2.4. Floating Point</a>
<ul>
<li><a href="#org37fafe8">2.4.1. Fractional Binary Numbers</a></li>
<li><a href="#org4e9e454">2.4.2. IEEE Floating-Point Representation</a></li>
<li><a href="#orgaa33d36">2.4.3. Rounding</a></li>
<li><a href="#org5e96b55">2.4.4. Floating-Point Operations</a></li>
<li><a href="#org386e38b">2.4.5. Floating Point in C</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org31caf2e">3. Q&amp;A in Machine-Level Representation of Programs</a>
<ul>
<li><a href="#orgbe497ee">3.1. What does the option <code>-01</code> do in the following command line?</a></li>
<li><a href="#org8cec023">3.2. What is ISA, and what does it do?</a></li>
<li><a href="#orge42b626">3.3. Do you know which parts of the processor state are visible that normally hidden from the C programmer?</a></li>
<li><a href="#orgf62fb71">3.4. What do you see in the following picture?</a></li>
<li><a href="#org8e90df1">3.5. What about this one?</a></li>
<li><a href="#org0adaeee">3.6. Some important instructions!</a></li>
<li><a href="#org2be85e0">3.7. Is there any restrictions when using data move instructions?</a></li>
<li><a href="#orge6badd4">3.8. How can you copy a value from a small location to a larger location?</a></li>
<li><a href="#org66a6287">3.9. How can you derive the bytes an instruction requires from its 'pattern'?</a></li>
<li><a href="#orgc0d8e1b">3.10. Why bother <code>push</code> while you can use <code>sub</code> and <code>mov</code>?</a></li>
<li><a href="#org9c7e6c1">3.11. What's wrong with the following code?</a></li>
<li><a href="#org8e3fac0">3.12. What is the address of the <code>mov</code> instruction?</a></li>
<li><a href="#orgb49468b">3.13. What is the relationship between the annotation on the right and the byte coding on the left?</a></li>
<li><a href="#org36862ba">3.14. What is the address of the jump target?</a></li>
<li><a href="#org3697abe">3.15. Why the assembly code contains two conditional branches, even though the C code has only one <code>if</code> statement?</a></li>
<li><a href="#orge52ef63">3.16. How the compilers generate loop code?</a></li>
<li><a href="#org4888d24">3.17. Why can code based on <b>conditional data transfer</b> outperform code based on conditional control transfer?</a></li>
<li><a href="#org4deb9f0">3.18. What's the differences between <code>jmp</code>, <code>set</code> and <code>cmov</code> ?</a></li>
<li><a href="#org3e55b4a">3.19. What the peculiarities of  the conditional move are?</a></li>
<li><a href="#org5cb6f62">3.20. How conditional operations can be implemented via conditional data transfers?</a></li>
<li><a href="#org31909a6">3.21. Heads up: JUMP TABLE</a></li>
<li><a href="#org2a230b1">3.22. Consider the following code and answer what the values are of the case labels in the `switch` statement body.</a></li>
<li><a href="#org667acd8">3.23. Procedures</a>
<ul>
<li><a href="#org943f78e">3.23.1. So what is a stack frame structure?</a></li>
<li><a href="#orga77ce9f">3.23.2. Transferring control</a></li>
<li><a href="#org0012665">3.23.3. Some register usage conventions</a></li>
<li><a href="#org8a8d44c">3.23.4. Example codes</a></li>
<li><a href="#org9e58f9e">3.23.5. Why does GCC allocate space that never gets used?</a></li>
<li><a href="#org4e67553">3.23.6. Recursive procedures</a></li>
</ul>
</li>
<li><a href="#orgd1063ce">3.24. Array allocation and access</a></li>
<li><a href="#org6916c6e">3.25. Heterogeneous data structures</a>
<ul>
<li><a href="#org3848815">3.25.1. Why <code>i</code> has offset 4 in <code>S3</code> rather than 1?</a></li>
</ul>
</li>
<li><a href="#org8d154e2">3.26. What happend after buffer overflow?</a></li>
<li><a href="#org33bfd3e">3.27. Three ways to thwart buffer overflow</a>
<ul>
<li><a href="#orgb7670b5">3.27.1. Stack randomization</a></li>
<li><a href="#orgb3a14ec">3.27.2. Stack corruption detection</a></li>
<li><a href="#org4303f8f">3.27.3. Limiting executable code regions</a></li>
</ul>
</li>
<li><a href="#org946827e">3.28. Some of the key differences between IA32 and x86-64</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org40301da" class="outline-2">
<h2 id="org40301da"><span class="section-number-2">1</span> A tour</h2>
<div class="outline-text-2" id="text-1">
<p>
<b>Files</b> include <b>text files</b> which consist exclusively of ASCII
characters and <b>binary files</b> (all other files).
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/compile-system.png" alt="compile-system.png">
</p>
<p><span class="figure-number">Figure 1: </span>The compilation system</p>
</div>

<ul class="org-ul">
<li><i>Preprocessing phase</i>: Reading the header file and insert it(them)
into the C program text and generating another C program text
(<code>hello.i</code>).</li>

<li><p>
<i>Compilation phase</i>: Compiler translate the text file <code>hello.i</code> into
the text file <code>hello.s</code>, which contains assembly language program.
</p>

<blockquote>
<p>
Each statement in an assembly language program <b>exactly</b> describes
<b>one</b> low-level machine language instruction in a standard text form.
Assembly language is useful because it provides a common output
language for different compilers for different high-level languages.
For example, C compilers and Fortran compilers both generate output
files in the same assembly language.
</p>
</blockquote></li>

<li><p>
<i>Assembly phase</i>: Next, the assembler translates <code>hello.s</code> into
machine language instructions, packages the in a form known as a
<i>relocatable object program</i>, and stores the result in the object
file <code>hello.o</code>.
</p>
<blockquote>
<p>
The <code>hello.o</code> file is a <b>binary file</b> whose bytes encode machine
language instructions rather than characters.
</p>
</blockquote></li>

<li><p>
<i>Linking phase</i>: The linker merges the <code>printf.o</code> and <code>hello.o</code> into
<code>hello</code> or <code>hello.exe</code>, which is an <i>executable object file/(or
simply /executable</i>) that is ready to be loaded into memory and
executed by the system. Object code is one form of machine code, but
the address of global values are not yer filled in.
</p>
<blockquote>
<p>
The hello program calls the function <code>printf</code>, <b>which is a part of the
<i>standard C library</i> provided by every C compiler.</b> The <code>printf</code>
function <b>resides in a separate precompiled object file</b> called
<code>printf.o</code>, which must somehow be merged with <code>hello.o</code> program.
The GNU project
</p>

<p>
*GNU*(short for GNU's Not Unix) environment includes the EMACS editor,
GCC compiler, GDB debugger, assembler, linker, utilities for
manipulating binaries, and other components.
</p>
</blockquote></li>
</ul>

<p>
If the <b>first word</b> of the command line does not correspond to built-in
shell command, then the shell will take it <b>as an executable file</b> and
assume it should be load and run.
</p>

<p>
<b>Busses</b> carries information back and forth between the components and
are typically designed to transfer <b>fixed-sized</b> chunks of bytes known
as <i>words</i>.
</p>

<blockquote>
<p>
Word size varies across systems. Most machines today have word sizes
of either 4 bytes(32bits) or 8 bytes(64bits).
</p>
</blockquote>

<p>
<b>I/O devices</b> are the system's connection to the external world. Each
<b>I/O device</b> is connected to the I/O bus by either a <i>controller</i> or
<i>adapter</i>. The main distinction between them is one of packaging.
<i>Controllers</i> are chip sets in the device itself or on the system's
motherboard. An <i>adapter</i> is a card that plugs into a slot on the
motherboard.
</p>

<p>
<b>Main Memory</b>, which physically consists of a series of DRAM(dynamic
random access memory) chips, is a <i>temporary</i> storage device that holds
both a program and the data it manipulates while the processor is
executing the program.
</p>

<p>
The central processing unit(<b>CPU</b>) or simply processor, is the engine
that <b>interprets instruction</b> that stored in main memory. At its core is
a <b>word-sized storage device</b> (or <b>register</b>) called the program
counter(<b>PC</b>). While the system is running, the processor repeatedly
interprets(or execute) instructions pointed by the PC and then updates
PC to point to new instructions.
</p>

<p>
There are only a few operations, and they revolve around the main
memory, the register file and the arithmetic/logic unit(ALU). The
<i>register file</i> is a <b>small storage device</b> the consits of a collection
of <b>word-sized registers</b>. each with its own unique name. The ALU
computes new data and address values.
</p>

<ul class="org-ul">
<li><i>Load</i>: <b>Copy</b> a byte or a word from <b>main memory into a register</b>,
<b>overwriting</b> the previous contents of the register.</li>
<li><i>Store</i>: <b>Copy</b> a byte or a word form <b>a register to a location in
main memory</b>, <b>overwriting</b> the previous contents of that location.</li>
<li><i>Operate</i>: <b>Copy</b> the contents of two <b>registers to the ALU</b>, perform
an arithmetic operation on the two words, and store the result in a
register, <b>overwriting</b> the previous contents of that register.</li>
<li><i>Jump</i>: <b>Extract</b> a word from the instruction itself and <b>copy</b> that
<b>word into</b> the program counter(<b>PC</b>), <b>overwriting</b> the previous
value of the PC.</li>
</ul>

<p>
<b>An important physical laws</b>: large storage devices are slower than the
small storage devices.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/os-hierarchy.png" alt="os-hierarchy.png">
</p>
</div>

<p>
From the top of memory hierarchy table to the bottom, the storage
devices become larger, slower, and less costly per byte. The L1, L2 and
L3 cache are implemented with a hardware technology known as <b><i>static
random access memory</i></b>. The idea behind caching is that a system can get
the effect of both a very large memory and a very fast one by exploit
<i>locality</i>, the tendency off programs to access data and code in
localised regions.
</p>

<ul class="org-ul">
<li>CPU registers hold <b>words</b> retrieved from L1 cache.</li>
<li>L1 cache holds <b>cache lines</b> retrieved from L2 cache.</li>
<li>L2 cache holds <b>cache lines</b> retrieved from L3 cache.</li>
<li>L3 cache holds <b>cache lines</b> retrieved from Main memory.</li>
<li>Main memory holds <b>disk block</b> retrieved from local disks.</li>
<li>Local disks hold <b>files</b> retrieved from disks on remote network
server.</li>
</ul>

<p>
Files are abstractions for I/O devices. A <b>file</b> is a sequence of bytes,
<i>nothing more and nothing less</i>. Every I/O device, including disks,
keyboards, displays, and even networks is modelled as a file. This
elegant notation provides applications with a uniform view of all of the
varied I/O devices. All input and output in the system is performed by
reading and writing files, using a small set of systems calls known as
<i>Unix I/O</i>.
</p>

<p>
A process is the operating system's abstraction for a running program.
Multiple processes can run <b>concurrently</b> on the same system.By
<b>concurrently</b>, we mean that the instructions of one process is
interleaved with instructions of another process.
</p>

<blockquote>
<p>
The operating system performs this interleaving with a mechanism known
as <b>context switching</b> by <b>saving the context</b>, which includes
information such as the current values of the PC, the register file
and the contents of main memory, of the current process, <b>restoring
the context</b> of the new process, and then <b>passing control</b> to the new
process. The new process picks up exactly where it left off.
</p>
</blockquote>

<p>
Basically, in a modern system a process can actually consist of multiple
execution units, called <b>threads</b>, each running in the context of the
process and sharing the same code and global data.
</p>

<blockquote>
<p>
It's easier to share data between threads than processes and typically
more efficient than processes. <b>Multi-threading</b> is one way to make
program run faster when multiple processors are available.
</p>
</blockquote>

<p>
Virtual memory is an abstraction that provides each process with the
<b>illusion</b> that it has exclusive use of the main memory.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/virtual-space.png" alt="virtual-space.png">
</p>
<p><span class="figure-number">Figure 3: </span>The virtual address space.</p>
</div>

<p>
In Linux, the <b>topmost region</b> of the address space is reserved for the
code and data in the <b>operating system</b> that is common to all processes.
The <b>lower region</b> of the address space holds the code and data <b>defined
by the user's process</b>.
</p>

<blockquote>
<p>
Addresses in the figure increase from the bottom to top.
</p>
</blockquote>

<ul class="org-ul">
<li><b><i>Program code and data.</i></b> Code <b>begins at the same fixed address</b>
for all processes, followed by data locations that correspond to
<b>global C variables</b>. The code and data areas are initialised
directly from the contents of an executable object file, in our case
the <code>hello</code> executable.</li>

<li><b><i>Heap.</i></b> The code data areas are followed immediately by the
<i>run-time</i> heap. Unlike the code and data areas which are fixed in
size, the heap <b>expands and contract dynamically</b> at run time as a
result of calls of C standard library routines such as <code>malloc</code> and
free.</li>

<li><b><i>Shared libraries.</i></b> Near the middle of the address space is an area
that holds the code and data for <i>shared libraries</i> such as the C
standard library and the math library.</li>

<li><b><i>Stack.</i></b> At the top of the virtual address space is the <i>user
stack</i> that <b>the compilers uses to implement functions calls</b>. Like
the heap, the user stack <b>expands and contracts dynamically</b>. In
particular, it grows when we call a function and contracts when we
return from a function.</li>

<li><b><i>Kernel virtual memory.</i></b> The kernel is the part of the operation
system that is <b>always resident in memory.</b> The top region is
<b>reserved</b> for the kernel. *Applications are not allowed to read or
write the contents of this area or directly call functions defined in
the kernel code.*</li>
</ul>

<blockquote>
<p>
The operating system kernel serves as an intermediary between the
applications and the hardware. It provides three fundamental
abstractions:
</p>

<ol class="org-ol">
<li>Files are abstractions for I/O devices.</li>

<li>Virtual memory is an abstraction for both main memory and disks.</li>

<li>Processes are abstractions for the processor, main memory, and I/O
devices.</li>
</ol>
</blockquote>

<p>
<b>CONCURRENCY &amp; PARALLELISM</b>
</p>

<p>
The term of concurrency is used to refer to the general concept of a
system with multiple, simultaneous activities and the term of
parallelism is used to refer the use of concurrency to make a system run
faster. Parallelism can be exploited at multiple levels of abstractions
in a computer system. Three levels are highlighted here, working form
the highest to the lowest level in the system hierarchy.
</p>

<ul class="org-ul">
<li>Thread-level Concurrency</li>
</ul>

<p>
With concurrency, multiple programs can be executed at the same time.
But, traditionally, this can be only <b>simulated</b>, by having a single
computer <i>rapidly</i> switch among its executing processes, much as a
juggler keeps multiple balls flying through the air. Until recently,
most actual computing was done by a configuration is known as a
<i>uniprocessor system</i>. With the advent of the <i>multi-core processor</i> and
<i>hyper-threading</i>.
</p>

<p>
Multi-core processors have several CPUs (referred as "cores") integrated
onto a single integrated-circuit chip, <b>each</b> of which *with its own L1
and L2 cache but sharing the higher levels of caches as well as the
interface to main memory.*
</p>

<p>
Hyper-threading, sometimes called <i>simultaneous multi-threading</i>, is a
technique that allows a single CPU to execute multiple flows of control.
It involves having <b>multiple copies</b> of some of the CPU hardware, such
as <b>program counters and register files</b>, while having only <b>single
copies</b> of other parts of the hardware, such as the <b>units that perform
floating-point arithmetic.</b>
</p>

<p>
A hyper-threaded processor enables the CPU to make better advantage of
its processing resources. The Intel Core i7 processor can have each cor
executing to threads, and so a four-core system can actually execute
eight threads in parallel.
</p>

<p>
The use of multi-processing can improve system performance in <b>two
ways</b>. First, it reduces the need to simulate concurrency when
performing <b>multiple</b> tasks. Second, it can run a single application
program <b>faster</b>.
</p>

<ul class="org-ul">
<li>Instruction-Level Parallelism</li>
</ul>

<p>
At a much lower level of abstraction, modern processors can execute
multiple instructions at one time, a property known as
<i>instruction-level parallelism</i>. In <b>pipelining</b>, the actions required
to execute an instruction are <b>partitioned into different steps</b> and the
processor hardware is organised as <b>a series of stages</b>, each performing
one of these steps.
</p>

<p>
Processors that can sustain execution rates faster than one instruction
per clock cycle are known as <i>superscalar</i>.
</p>

<ul class="org-ul">
<li>Single-Instruction, Multiple Data(SIMD) Parallelism</li>
</ul>

<p>
At the lowest level, many modern processors have special hardware that
allows a single instruction to cause multiple operations to be performed
in parallel, which is known as SIMD parallelism. These SIMD instructions
are provided mostly to speed up applications that process images, video
and sound data.
</p>



<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/abstractions-of-computer.png" alt="abstractions-of-computer.png">
</p>
</div>
</div>
</div>
<div id="outline-container-orge4eb835" class="outline-2">
<h2 id="orge4eb835"><span class="section-number-2">2</span> Representing and Manipulating Information</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org1839ff5" class="outline-3">
<h3 id="org1839ff5"><span class="section-number-3">2.1</span> Information Storage</h3>
<div class="outline-text-3" id="text-2-1">
<p>
A machine level program views memory as a large array of bytes, referred
as <b><i>virtual memory</i></b>. Each byte of memory is defined by a unique
number, known as its address, and the set of all possible addresses is
known as the <b><i>virtual address space</i></b>.
</p>

<p>
The value of a pointer in C is the virtual address of the <b>first byte</b>
of some block of storage.
</p>

<p>
Every computer has a <b>word size</b>, indicating <b>the nominal size of
integer and pointer data</b>. Since a virtual address is encoded by such a
word, the most important parameter in computer system determined by such
a word is the maximum size of the virtual address space. That is, if a
computer has a ùë§-bit word size, the virtual address of it can arrange
from 0 ~ 2<sup>ùë§</sup>Ôºç1, giving the program access at most 2<sup>ùë§</sup> bytes.
</p>

<p>
For most computer with a 32-bit word size, the limits of its virtual
space is to 4 Gigabytes (4 GB), that is, <b>just over</b> 4 √ó 10<sup>9</sup> bytes.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/sizes-of-data-types.png" alt="sizes-of-data-types.png">
</p>
<p><span class="figure-number">Figure 5: </span>sizes of data types</p>
</div>

<blockquote>
<p>
The C data type <code>char</code> represents a singe byte. A <code>long int</code> uses the
full word size of the machine. Unsigned numbers obey the law of
arithmetic modulo 2<sup>ùëõ</sup>, where ùëõ is the number of bits in the type.
So, for instance, if <code>short</code> is 16 bits, then <code>unsigned short</code>
variables have the value between <code>0</code> and <code>65535</code>.
</p>

<p>
The <code>long long</code> type, so as the <code>char *</code> type, allows the full range
of the 64-bit integers. *For 32-bit machines, the compiler must
compile operations for this data type by generating code that performs
sequences of 32-bit operations.*
</p>
</blockquote>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/bi-endian.png" alt="bi-endian.png">
</p>
<p><span class="figure-number">Figure 6: </span>bi-endian</p>
</div>

<blockquote>
<p>
Note that in the word <code>0x01234567</code>, the high-order byte has
hexadecimal value <code>0x01</code>, while the low-order has hexadecimal value
<code>0x67</code>.
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #b22222;">/* </span><span style="color: #b22222;">Code to print hte byte representation of program objects </span><span style="color: #b22222;">*/</span>
<span style="color: #b22222;">/* </span><span style="color: #b22222;">This code uses casting to circumvent the type system, accessing and printing the byte representations of the program object </span><span style="color: #b22222;">*/</span>

<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;stdio.h&gt;</span>

<span style="color: #a020f0;">typedef</span> <span style="color: #228b22;">unsigned</span> <span style="color: #228b22;">char</span> *<span style="color: #228b22;">byte_pointer</span>;

<span style="color: #228b22;">void</span> <span style="color: #0000ff;">show_bytes</span>(<span style="color: #228b22;">byte_pointer</span> <span style="color: #a0522d;">start</span>, <span style="color: #228b22;">int</span> <span style="color: #a0522d;">len</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>;
    <span style="color: #a020f0;">for</span>(i = 0; i &lt; len; i++)
        printf(<span style="color: #8b2252;">"%.2x"</span>,start[i]);
    printf(<span style="color: #8b2252;">"\n"</span>);
}

<span style="color: #228b22;">void</span> <span style="color: #0000ff;">show_int</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>)
{
    show_bytes((<span style="color: #228b22;">byte_pointer</span>)&amp;x, <span style="color: #a020f0;">sizeof</span>(<span style="color: #228b22;">int</span>));
}

<span style="color: #228b22;">void</span> <span style="color: #0000ff;">show_float</span>(<span style="color: #228b22;">float</span> <span style="color: #a0522d;">x</span>)
{
    show_bytes((<span style="color: #228b22;">byte_pointer</span>)&amp;x, <span style="color: #a020f0;">sizeof</span>(<span style="color: #228b22;">float</span>));
}

<span style="color: #228b22;">void</span> <span style="color: #0000ff;">show_pointer</span>(<span style="color: #228b22;">void</span> *<span style="color: #a0522d;">x</span>)
{   <span style="color: #b22222;">//</span><span style="color: #b22222;">data type void is a special kind of pointer with no associcated type information.</span>
    show_bytes((<span style="color: #228b22;">byte_pointer</span>)x, <span style="color: #a020f0;">sizeof</span>(<span style="color: #228b22;">void</span> *));
}
</pre>
</div>

<p>
As ASCII has its own character code, independent of the byte ordering
and word size conventions, text data is more platform-independent than
binary data.
</p>

<p>
Generally, machines support two ways of right shift operation: <b><i>logical
and arithmetic</i></b>. A logical right shift fills the left end with ùëò zeros
and an arithmetic right shift with ùëò repetitions of the <b>most
significant bit</b>. The C standards don't precisely define which type of
right shift should be used. *For signed data, right shift must be
logical, and for signed data, either logical or arithmetic shifts may be
used*. In practise, however, <b>the most of the compiler/machine
combinations use arithmetic right shifts for signed data</b>.
</p>
</div>
</div>

<div id="outline-container-org470f386" class="outline-3">
<h3 id="org470f386"><span class="section-number-3">2.2</span> Integer Representations</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Casting the signed number to unsigned number in the same bit size or
vice versa is to keep the bit values identical but change how these bits
are interpreted.
</p>

<p>
When an operation (or comparison) is performed where both signed and
unsigned operands are involved, <b>C implicitly cast the signed operand to
unsigned</b> and performs the operation assuming the numbers are
nonnegative.
</p>

<blockquote>
<p>
<b>INTERESTING ASIDE</b>
</p>

<p>
When writing <b><i>TMin</i></b> in C, we carefully wrote the value of
<b><i>TMin<sub>32</sub></i></b> as <code>-2147483647Ôºç1</code>. Looking at the header file
<code>limits.h</code>, we see that they use a similar method to write <i>TMin<sub>32</sub></i>
and <i>TMax<sub>32</sub></i>:
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #483d8b;">#define</span> <span style="color: #a0522d;">INT_TMAX</span> 2147483647
<span style="color: #483d8b;">#define</span> <span style="color: #a0522d;">INT_TMIN</span> (-INT_TMAX - 1)
</pre>
</div>

<blockquote>
<p>
A curious interaction between the asymmetry of the two's complement
representation and the convention rules of C force us to write
<i>TMin<sub>32</sub></i> in this unusual way.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/tmin-test.png" alt="tmin-test.png">
</p>
<p><span class="figure-number">Figure 7: </span>TMin test</p>
</div>

<p>
When the compiler encounters a number of the form <code>‚àíX</code>, it <b>first
determines the data type and value for <code>X</code> and then negates it</b>. The
value <code>2147483648</code> is too large to represent as an <code>int</code>, since this
value is one larger than <i>TMax<sub>32</sub></i> (the asymmetry strikes!). The
compiler tries to determine a data type that can represent this value
properly. It proceeds down one of the lists shown for the decimal
cases in the figure below.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/data-orders.png" alt="data-orders.png">
</p>
<p><span class="figure-number">Figure 8: </span>Data Orders</p>
</div>

<p>
Now we see why <code>‚àí2147483648</code> won't do the trick.
</p>
</blockquote>

<p>
One point worth making is that the relative order of conversion between
one data size to another and between unsigned and signed can affect the
behaviour of a program.
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #228b22;">short</span> <span style="color: #a0522d;">sx</span> = -12345;
<span style="color: #228b22;">unsigned</span> <span style="color: #a0522d;">uy</span> = sx;

printf(<span style="color: #8b2252;">"sx = %d:\t"</span>, sx);
show_bytes((byte_pointer)&amp;sx, <span style="color: #a020f0;">sizeof</span>(<span style="color: #228b22;">unsigned</span>));
printf(<span style="color: #8b2252;">"uy = %u:\t"</span>, uy);
show_bytes((byte_pointer)&amp;uy, <span style="color: #a020f0;">sizeof</span>(<span style="color: #228b22;">unsigned</span>));
</pre>
</div>

<p>
When run on a big-endian machine, this code causes the following output
to be printed:
</p>

<div class="org-src-container">
<pre class="src src-C">sx = -12345:    cfc7
uy = 4294954951:    ffffcfc7
</pre>
</div>

<p>
This shows us that when converting from <code>short</code> to <code>unsigned</code>, we first
change the size and then from <code>signed</code> to <code>unsigned</code>. That is,
<code>(unsigned)sx</code> is equivalent to <code>(unsigned)(int)sx</code>, not
<code>(unsigned)(unsigned short)sx</code>.
</p>
</div>
</div>

<div id="outline-container-org7e52d48" class="outline-3">
<h3 id="org7e52d48"><span class="section-number-3">2.3</span> Integer Arithmetic</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orgf0bb3bf" class="outline-4">
<h4 id="orgf0bb3bf"><span class="section-number-4">2.3.1</span> Unsigned Addition</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Unsigned arithmetic can be viewed as a form of modular arithmetic.
Unsigned addition is equivalent to computing the sum modulo <i>2<sup>ùë§</sup></i>.
This value can be computed by simply discarding the high-order bit in
the ùë§Ôºã1-bit representation in ùë•Ôºãùë¶.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/unsigned-addition.png" alt="unsigned-addition.png">
</p>
<p><span class="figure-number">Figure 9: </span>Unsigned</p>
</div>

<p>
When executing C programs, overflows are not signalled as errors.
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #b22222;">/* </span><span style="color: #b22222;">Determin whether arguments can be added without overflow </span><span style="color: #b22222;">*/</span>
<span style="color: #228b22;">int</span> <span style="color: #0000ff;">uadd_ok</span>(<span style="color: #228b22;">unsigned</span> <span style="color: #a0522d;">a</span>, <span style="color: #228b22;">unsigned</span> <span style="color: #a0522d;">b</span>)
{
    <span style="color: #228b22;">unsigned</span> <span style="color: #a0522d;">sum</span> = a + b;
    <span style="color: #a020f0;">return</span> sum &gt;= a;
}
</pre>
</div>

<p>
If sum did not overflow, surely ùë†ùë¢ùëö ‚â• ùëé. If sum did overflow, then ùë†ùë¢ùëö =
ùë•Ôºãùë¶Ôºç2<sup>ùë§</sup>, which ùë¶Ôºç2<sup>ùë§</sup>Ôºú0, so ùë†ùë¢ùëöÔºúùë•;
</p>
</div>
</div>

<div id="outline-container-org216999c" class="outline-4">
<h4 id="org216999c"><span class="section-number-4">2.3.2</span> Unsigned Negation</h4>
<div class="outline-text-4" id="text-2-3-2">

<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/unsigned-negation.png" alt="unsigned-negation.png">
</p>
<p><span class="figure-number">Figure 10: </span>Unsigned Negation</p>
</div>
</div>
</div>

<div id="outline-container-org54c1d8b" class="outline-4">
<h4 id="org54c1d8b"><span class="section-number-4">2.3.3</span> Unsigned Multiplication</h4>
<div class="outline-text-4" id="text-2-3-3">
<p>
Unsigned multiplication operation can be viewed to be equivalent to
computing the product modulo 2<sup>ùë§</sup>, which yields the ùë§-bit value given
by the low-order ùë§ bits of the product.
</p>
</div>
</div>

<div id="outline-container-org7c746d8" class="outline-4">
<h4 id="org7c746d8"><span class="section-number-4">2.3.4</span> Two's Complement Additon</h4>
<div class="outline-text-4" id="text-2-3-4">
<p>
Observe that the result can also be obtained by performing binary
addition of the operands and truncating the result to w bits.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/two-s-complement-addition.png" alt="two-s-complement-addition.png">
</p>
<p><span class="figure-number">Figure 11: </span>Two's Complement Addition</p>
</div>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #b22222;">/* </span><span style="color: #b22222;">Determing whether arguments can be added without overflow </span><span style="color: #b22222;">*/</span>

<span style="color: #228b22;">int</span> <span style="color: #0000ff;">tadd_ok</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>, <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">sum</span> = x+y;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">pos_over</span> = x &gt;= 0 &amp;&amp; y &gt;= 0 &amp;&amp; sum &lt; 0;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">neg_over</span> = x &lt; 0 &amp;&amp; y &lt; 0 &amp;&amp; sum &gt;= 0;
    <span style="color: #a020f0;">return</span> !pos_over &amp;&amp; !neg_over;
}

<span style="color: #b22222;">/* </span><span style="color: #b22222;">WARING: This is a buggy code </span><span style="color: #b22222;">*/</span>
<span style="color: #228b22;">int</span> <span style="color: #0000ff;">tadd_ok_buggy</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>, <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">sum</span> = x+y;
    <span style="color: #a020f0;">return</span> (sum-x == y)&amp;&amp;(sum-y == x);
    <span style="color: #b22222;">/* </span><span style="color: #b22222;">Since two's complement addition forms an abelian group, and so the expression (x+y)-x will always evaluate to y regardless of whether or not the addition overflows. </span><span style="color: #b22222;">*/</span>
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org93ec3d0" class="outline-4">
<h4 id="org93ec3d0"><span class="section-number-4">2.3.5</span> Two's Complement Negation</h4>
<div class="outline-text-4" id="text-2-3-5">

<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/two-s-complement-negation.png" alt="two-s-complement-negation.png">
</p>
</div>
</div>
</div>


<div id="outline-container-org84cefe0" class="outline-4">
<h4 id="org84cefe0"><span class="section-number-4">2.3.6</span> Two's Complement Multiplication</h4>
<div class="outline-text-4" id="text-2-3-6">
<p>
Signed multiplication in C generally is performed by truncation the
2ùë§-bit product to ùë§ bits.We claim that the bit-level representation of
the product operation is identical for both unsigned and two's
complement multiplication.
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #b22222;">/* </span><span style="color: #b22222;">Determine whether arguments can be multiplied without overflow </span><span style="color: #b22222;">*/</span>
<span style="color: #228b22;">int</span> <span style="color: #0000ff;">tmult_ok</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>, <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">p</span> = x*y;
    <span style="color: #b22222;">/* </span><span style="color: #b22222;">Either x is zero, or dividing p by x gives y </span><span style="color: #b22222;">*/</span>
    <span style="color: #a020f0;">return</span> !x || p/x == y;
}
<span style="color: #b22222;">/* </span><span style="color: #b22222;">Determine whether arguments can be multiplied without overflow without using dividing </span><span style="color: #b22222;">*/</span>
<span style="color: #228b22;">int</span> <span style="color: #0000ff;">tmult_ok_nodivi</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>, <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span>)
{
    <span style="color: #b22222;">/* </span><span style="color: #b22222;">Computer product without overflow </span><span style="color: #b22222;">*/</span>
    <span style="color: #228b22;">long</span> <span style="color: #228b22;">long</span> <span style="color: #a0522d;">pll</span> = (<span style="color: #228b22;">long</span> <span style="color: #228b22;">long</span>)<span style="color: #228b22;">x</span>*<span style="color: #a0522d;">y</span>;
    <span style="color: #b22222;">/* </span><span style="color: #b22222;">See if casting to int preseves value </span><span style="color: #b22222;">*/</span>
    <span style="color: #a020f0;">return</span> pll == (<span style="color: #228b22;">int</span>)pll;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org93e7a1a" class="outline-4">
<h4 id="org93e7a1a"><span class="section-number-4">2.3.7</span> Multiplying by Constants</h4>
<div class="outline-text-4" id="text-2-3-7">
<p>
On most machines, the integer multiply instruction is fairly slow,
requiring 10 or more clock cycles, whereas other integer
operations&#x2014;such as addition, subtraction, bit-level operations, and
shifting&#x2014;require only 1 clock cycle.
</p>

<p>
For an unsigned or signed variable ùë•, the C expression <code>x&lt;&lt;k</code> is
equivalent to <code>x * pwr2k</code>, where <code>pwr2k</code> equals 2<sup>ùëò</sup>.
</p>

<blockquote>
<p>
Multiplying by a power of 2 can cause overflow with either unsigned or
two's complement arithmetic. Still, we will get the same effect by
shifting.
</p>
</blockquote>

<p>
14 can be written as <code>(0...0)(111)(0)</code>. Consider a run of ones from bit
position ùëõ down to bit position ùëö (ùëõ ‚â• ùëö). We can compute the effect of
these bits on the product using either of two different forms:
</p>

<p>
‚Äã <b>Form A:</b> <code>(x&lt;&lt;n) + (x&lt;&lt;n-1) + ... + (x&lt;&lt;m)</code>
</p>

<p>
‚Äã <b>Form B:</b> <code>(x&lt;&lt;n+1) - (x&lt;&lt;m)</code>
</p>

<p>
When the ùëõ is the most significant bit in <b>Form B</b>, it simply becomes
<code>-(x&lt;&lt;m)</code>.
</p>

<p>
Some special cases:
</p>

<ul class="org-ul">
<li><code>55</code> has the bit representation of <code>110111</code>, so <code>x * 55</code> can be
computed by <code>(x&lt;&lt;6) - (x&lt;&lt;0) - (x&lt;&lt;3)</code>. (We can view this bit pattern
as having a run of 6 ones with a zero in the middle, and so we apply
the rule of Form B, but then <b>subtract the term corresponding to the
middle zero bit</b>);</li>
<li><code>-6</code> has the bit representation of <code>1010</code>, so <code>x * (-6)</code> can be
computed by <code>-(x&lt;&lt;3)+(x&lt;&lt;1)</code>. (Where the most significant bit is the
signed bit).</li>
</ul>
</div>
</div>

<div id="outline-container-org079f43f" class="outline-4">
<h4 id="org079f43f"><span class="section-number-4">2.3.8</span> Dividing by Powers of Two</h4>
<div class="outline-text-4" id="text-2-3-8">
<p>
Integer division requires more than 30 or more clock cycles on most
moachines. Dividing by powers of two can be performed by a right shift
operarion. The two different shifts&#x2014;logical and arithmetic&#x2014;serve
this purpose for unsigned and two's complement numbers, respectively.
</p>

<p>
<b>Integer division always rounds toward zero</b>. For ùë• ‚â• 0 and ùë¶ ‚â• 0, the
result should be ‚é£ùë•/ùë¶‚é¶. ‚é£Ôºç3.14‚é¶= Ôºç4.
</p>

<p>
Applying a logical right shift by ùëò to an unsigned number gives the same
results dividing by 2<sup>ùëò</sup>.
</p>

<p>
For a positive number, we have 0 as the most significant bit, and so the
effect is the same as for a logical right shift. Thus, an arithmetic
right shift by ùëò is the same for a nonnegative number.
</p>

<p>
But, for a <b>negative number</b>, only right shifting won't gives us what we
want. We need to <b>add a bias</b> before the right shift <b>in order to make
the result round towards zero</b>. For a two's complement machine using
arithmetic right shifts, the C expression <code>(x&lt;0 ? x+(1&lt;&lt;k)-1 : x) &gt;&gt; k</code>
is equivalent to <code>x / pwr2k</code>, where <code>pwr2k</code> equals 2<sup>ùëò</sup>.
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #b22222;">//</span><span style="color: #b22222;">INTERESTING FUNCTION!!</span>
<span style="color: #b22222;">/*</span><span style="color: #b22222;">This function returns the value x/16 for integer argument x, which uses a two's complement representation. </span><span style="color: #b22222;">*/</span>
<span style="color: #b22222;">/* </span><span style="color: #b22222;">Right shifts are performed arithmetically </span><span style="color: #b22222;">*/</span>
<span style="color: #228b22;">int</span> <span style="color: #0000ff;">div16</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>)
{
    <span style="color: #b22222;">/* </span><span style="color: #b22222;">Compute bias to be either 0 (x &gt;= 0) or 15 (x &lt; 0) </span><span style="color: #b22222;">*/</span>
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">bias</span> = (x &gt;&gt;31) &amp; 0xF;
    <span style="color: #a020f0;">return</span> (x + bias) &gt;&gt; 4;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d7ce56" class="outline-4">
<h4 id="org7d7ce56"><span class="section-number-4">2.3.9</span> Summary</h4>
<div class="outline-text-4" id="text-2-3-9">
<p>
When casting between signed and unsigned integers of the same size, most
C implementations follow the convention that the underlying bit pattern
does not change.
</p>

<p>
Both unsigned and two's-complement arithmetic satisfy many of the other
properties of integer arithmetic, including associativity,
commutativity, and distributivity.
</p>

<p>
Bit patterns, like <code>[0,...,0,1,...,1]</code>, consisting of ùë§Ôºçùëò zeros
followed by k ones, are useful for masking operations. This patter can
be generated by the C expression <code>(1&lt;&lt;k)-1</code>, exploiting the property
that the desired bit patter has numeric value 2<sup>ùëò</sup>-1.
</p>
</div>
</div>
</div>

<div id="outline-container-org10c36d6" class="outline-3">
<h3 id="org10c36d6"><span class="section-number-3">2.4</span> Floating Point</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org37fafe8" class="outline-4">
<h4 id="org37fafe8"><span class="section-number-4">2.4.1</span> Fractional Binary Numbers</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
Fractional binary numbers have the form ùëè<sub>ùëö</sub> ùëè<sub>ùëöÔºç1</sub> ¬∑¬∑¬∑ ùëè<sub>1</sub> ùëè<sub>0</sub> .
ùëè<sub>Ôºç1</sub> ùëè<sub>Ôºç2</sub> ¬∑¬∑¬∑ ùëè<sub>Ôºçùëõ</sub>. This notation represents a number ùëè defined
as:
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/fractional-binary-number.png" alt="fractional-binary-number.png">
</p>
<p><span class="figure-number">Figure 13: </span>Fractional binary number</p>
</div>


<p>
Fractional binary number can only represent numbers that can be written
ùë• √ó 2<sup>ùë¶</sup>. <b>Other values can only be approximated</b>. We increase accuracy
by lengthening the binary representation. For example, the number 1/5
can be represented exactly as the decimal number 0.20. As a fractional
binary number, however, it can't be represented exactly, but only
approximated.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/approximated-number.png" alt="approximated-number.png">
</p>
<p><span class="figure-number">Figure 14: </span>Approximated number</p>
</div>
</div>
</div>


<div id="outline-container-org4e9e454" class="outline-4">
<h4 id="org4e9e454"><span class="section-number-4">2.4.2</span> IEEE Floating-Point Representation</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
The IEEE (The Institute of Electrical and Electronic Engineers)
floating-point standard represents a number in a form Ôº∂ = (-1)<sup>ùë†</sup> √ó Ôº≠
√ó 2<sup>Ôº•</sup> :
</p>

<ul class="org-ul">
<li>The <i>sign</i> ùë† is the sign bit. 0 is the special case.</li>
<li>The <i>significand</i> Ôº≠ is between 1 to 2Ôºçùúñ or 0 to 1Ôºçùúñ.</li>
<li>The <i>exponent</i> Ôº• is what it is.</li>
</ul>

<p>
The bit representation of a floating-point number is divided into three
fields to encode these values:
</p>

<ul class="org-ul">
<li>The single sing bit ùë† is directly encodes the sign ùë†.</li>

<li>The ùëò-bit exponent field ùëíùë•ùëù = ùëí<sub>ùëòÔºç1</sub> ¬∑¬∑¬∑ ùëí<sub>1</sub> ùëí<sub>0</sub> encodes the
exponent Ôº•.</li>

<li>The ùëõ-bit fraction field ùëìùëüùëéùëê = ùëì<sub>ùëõÔºç1</sub> ¬∑¬∑¬∑ ùëì<sub>1</sub> ùëì<sub>0</sub> encodes the
significand Ôº≠. But the value encoded also depends on whether or not
the exponent field equals 0.</li>
</ul>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/IEEE-floating-point-representation.png" alt="IEEE-floating-point-representation.png">
</p>
<p><span class="figure-number">Figure 15: </span>IEEE Floating-Point Representation</p>
</div>
</div>


<ul class="org-ul">
<li><a id="org5dcc600"></a>CASE 1: Normalised Values.<br>
<div class="outline-text-5" id="text-org5dcc600">
<ul class="org-ul">
<li>BiasÔºù2<sup>ùëòÔºç1</sup>Ôºç1. Ôº•Ôºù ùëíÔºçBias;</li>
<li>Ôº≠Ôºù1Ôºãùëì;</li>
</ul>
</div>
</li>

<li><a id="orga1340b6"></a>CASE 2: Denormalised Values.<br>
<div class="outline-text-5" id="text-orga1340b6">
<ul class="org-ul">
<li>BiasÔºù2<sup>ùëòÔºç1</sup>Ôºç1. EÔºù1ÔºçBias.</li>
<li>MÔºùùëì;</li>
<li>Ôºã0(ùë†Ôºù0).</li>
<li>Ôºç0(ùë†Ôºù1).</li>
</ul>
</div>
</li>

<li><a id="org51e3a49"></a>CASE 3: Special Values.<br>
<div class="outline-text-5" id="text-org51e3a49">
<ul class="org-ul">
<li>Infinity and <i>NaN</i> ( Not a Number).</li>
</ul>

<p>
The representable numbers are not uniformly distributed&#x2014;they are
denser nearer the origin.
</p>

<p>
The smooth transition between the largest denormalised number and the
smallest normalised number is the result of making the Ôº≠ 1ÔºçBias rather
than ÔºçBias.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgaa33d36" class="outline-4">
<h4 id="orgaa33d36"><span class="section-number-4">2.4.3</span> Rounding</h4>
<div class="outline-text-4" id="text-2-4-3">
<p>
Four rounding models:
</p>

<ul class="org-ul">
<li><b>Round-to-even</b></li>
</ul>

<p>
For those rounding values that are halfway of two possible results. It
will round upward about 50% of the time and downward about 50% of the
time. For example, we will round both <code>1.235000</code> and <code>1.245000</code> to 1.24,
since 4 is even. When it comes to binary fractional number, those values
that are halfway between to possible results are rounded to the result
whose least significant bit is zero.
</p>

<ul class="org-ul">
<li>Round-towards-zero</li>

<li>Round-up</li>

<li>Round-down</li>
</ul>
</div>
</div>

<div id="outline-container-org5e96b55" class="outline-4">
<h4 id="org5e96b55"><span class="section-number-4">2.4.4</span> Floating-Point Operations</h4>
<div class="outline-text-4" id="text-2-4-4">
<p>
\[\frac{1}{-0}=-\infty \\ \frac{1}{+0}=+\infty\]
</p>

<p>
The results should be rounded. The operations are commutative but not
associative. The lack of associativity in floating-point addition is the
most important group property that is lacking.
</p>

<p>
Floating-point addition satisfies the following monotonicity: if ùëé ‚â• b
then ùë•Ôºãùëé ‚â• ùë•Ôºãùëè for any values of ùëé, ùëè, and ùë• other than <i>NaN</i>.
Floating-point multiplication satisfies the monotonicity but does not
distribute over addition;
</p>

<p>
None of these monotonicity properties hold for unsigned or two's
complement multiplicaiton;
</p>
</div>
</div>

<div id="outline-container-org386e38b" class="outline-4">
<h4 id="org386e38b"><span class="section-number-4">2.4.5</span> Floating Point in C</h4>
<div class="outline-text-4" id="text-2-4-5">
<p>
The GNU compiler GCC defines program constants <code>INFINITY</code> (for ‚àû) and
<code>NAN</code> (for <i>NAN</i>) when the following sequence occurs in the program
file:
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #483d8b;">#define</span> <span style="color: #a0522d;">GNU</span> SOURCE 1
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;math.h&gt;</span>
</pre>
</div>

<p>
When casting values between <code>int</code>, <code>float</code>, and <code>double</code> formats, the
program changes the numeric values and the bit representations as
follows (assuming a 32-bit <code>int</code>).
</p>

<ul class="org-ul">
<li>From <code>int</code> to <code>float</code> (same bytes), the number cannot overflow, but
it may be rounded.</li>
<li>From <code>int</code> or <code>float</code> to <code>double</code>, the exact numeric value can be
preserved because the <code>double</code> has both greater range and greater
precision.</li>
<li>From <code>double</code> to <code>float</code>, the value can overflow \(+\infty\) or \(-\infty\), since the range is smaller. Otherwise, it may be rounded, because the precision is smaller.</li>
<li>From <code>float</code> or <code>double</code> to <code>int</code> the value will be <b>rounded toward
zero</b>. For instance, 1.999 will be converted to 1, while Ôºç1.999 will
be converted to Ôºç1. Furthermore, the value may overflow. <b>Any   conversion from floating point to integer that cannot assign a
reasonable integer approximation yields <i>TMin<sub>w</sub></i>.</b> Thus, the
expression <code>(int) +1e10</code> yields <code>Ôºç21483648</code>, generating a negative
value from a positive one.</li>
</ul>

<blockquote>
<p>
<b>Intel IA32 Floating-Point Arithmetic</b>
</p>

<p>
IA32 processors, like most other processors, have special memory
elements called <i>registers</i> for holding floating point values as they
are being computed and used. <b>The unusual feature of IA32 is that the floating-point registers use a special 80-bit <i>extended-precision</i>  format to provide a greater range and precision then the normal 32-bit  single-precision and 64-bit double-precision formats used for values  held in memory.</b> All single- and double-precision numbers <b>are
converted to this</b> in <i>extended precision</i>. Numbers are converted from
extended precision to singe- or double-precision format as they are
stored in memory. <b>It means that storing a number from a register to  memory and then retrieving it back into the register can cause it to  change, due to rounding, underflow, or overflow.</b>
</p>
</blockquote>

<p>
Floating-point arithmetic must be used very carefully, because it has
only limited range and precision, and because it does not obey common
mathematical properties such as associativity.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org31caf2e" class="outline-2">
<h2 id="org31caf2e"><span class="section-number-2">3</span> Q&amp;A in Machine-Level Representation of Programs</h2>
<div class="outline-text-2" id="text-3">
<blockquote>
<p>
<b>Things You Should Know</b>
</p>

<ul class="org-ul">
<li><b><b>8086</b></b>: (1978, 29 K transistors). One of the first single-chip, 16-bit microprocessors. The 8088, a variant of the 8086 with an 8-bit external bus, formed the heart of the original IBM personal computers. The original models came with. 32768 bytes of memory and two floppy drives (no hard drive).  Architecturally, the machines were limited to a 655360-byte address space‚Äîaddresses were only 20 bits long (1048576 bytes addressable), and the operating system reserved 393216 bytes of its own use. In 1980, Intel introduced the 8087 floating-point coprocessor (45 K transistors) to operate alongside the 8086 or 8088 processor, executing the floating-point instructions. The 8087 established the floating-point model for the x86 line, often referred as "x87".</li>

<li><b><b>80286</b></b>: (1982, 134 K transistors). Added more (and now obsolete) addressing modes. Formed the basis of the IBM PC-AT personal computer, the original platform for MS Windows.</li>

<li><b><b>i386</b></b>: (1985, 275 K transistors). Expanded the architecture to 32 bits. Added the flat addressing model used by Linux and recent versions of the Windows family of operating system. This was the first machine in the series that could support a Unix operating system.</li>

<li><b><b>i486</b></b>: (1989, 1.2 M transistors). Improved performance and integrated the floating-point unit onto thee processor chip but did not significantly change the instruction set.</li>

<li><b><b>Pentium</b></b>: (1993, 3.1 M transistors). Improved performance, but only added minor extensions to the instruction set.</li>

<li><b><b>PentiumPro</b></b>: (1995, 5.5 M transistors). Introduced a radically new processor design, internally known as the <b>P6</b> microarchitecture. Added a call of "conditional move" instructions to the instruction set.</li>

<li><b><b>Pentium II</b></b>: (1997, 7 M transistors). Continuation of the P6 micro architecture.</li>

<li><b><b>Pentium III</b></b>: (1999, 8.2 M transistors). Introduced <b><b>SSE</b></b>, a calls of instructions for manipulating vectors of integer or floating-point data. Each datum can be 1, 2, or 4 bytes, packed into vectors of 128 bits. Later versions of this chip went up to 24 M transistors, due to the incorporation of the level-2cache on chip.</li>

<li><b><b>Pentium 4</b></b>: (2000, 42 M transistors). Extended SSE to SSE2, adding new data types (including double-precision floating-point), along with 144 new instructions for these formats. With these extensions, compilers can user SSR instructions, rather than x87 instructions, to compile floating-point code. Introduced the <b>NetBurst</b> microarchitecture, which could operate at very high clock speeds, but  at the cost of high power consumption.</li>

<li><b><b>Pentium 4E</b></b>: (2004, 125 M transistors). Addend <b>hyper-threading</b>, a method to run two programs simultaneously on a single processor, as well as EM64T, Intels implementation of a 64-bit extension to IAa32 developed by Advanced Micro Devices (AMD), which we refer to as x86-64.</li>

<li><b><b>Core 2</b></b>: (2006, 291 M transistors). Returned back to a microarchitecture similar to P6. First <b>multi-core</b> Intel microprocessor, where multiple processors are implemented on a single chip. Did not support hyper-threading.</li>

<li><b><b>Core i7</b></b>: (2008, 781 M transistors). Incorporated both hyper-threading and multi-core, with  initial version supporting two executing programs on each core and up to four cores on each chip.</li>
</ul>
</blockquote>
</div>

<div id="outline-container-orgbe497ee" class="outline-3">
<h3 id="orgbe497ee"><span class="section-number-3">3.1</span> What does the option <code>-01</code> do in the following command line?</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">
<pre class="src src-bash">gcc -01 -o p p1.c p2.c <span style="color: #b22222;"># </span><span style="color: #b22222;">note the difference from the more general one</span>
</pre>
</div>

<p>
The command-line option <code>-01</code> instructs the compiler to apply <b><b>level one optimisations</b></b>. Increasing the level of optimisation makes the program run faster, but at a risk of increased compilation time and difficulties running debugging tools on the code. The higher optimisation level is, the harder to understand the relationships between the source code and the machine code.
</p>
</div>
</div>

<div id="outline-container-org8cec023" class="outline-3">
<h3 id="org8cec023"><span class="section-number-3">3.2</span> What is ISA, and what does it do?</h3>
<div class="outline-text-3" id="text-3-2">
<p>
ISA, short for "Instruction Set Architecture", defines the format and behaviour of the machine-level program, which include the processor state, the format of the instructions, and the effect each of these instructions will have on the state.
</p>
</div>
</div>

<div id="outline-container-orge42b626" class="outline-3">
<h3 id="orge42b626"><span class="section-number-3">3.3</span> Do you know which parts of the processor state are visible that normally hidden from the C programmer?</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>The <b>program counter</b> (commonly referred to as the "PC", and called <code>%eip</code> in IA32) indicates the address in memory of the next instruction to be executed.</li>

<li>The integer <b>register file</b>  contains eight named locations storing 32-bits values. These registers can hold integer data or addresses (corresponding to the C pointers). Some of the registers are used to keep track of critical parts of the program state, while others are used to hold temporary data, such as the local variables of the procedure, and the value to be returned by a function.</li>
</ul>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/ia32-integer-registers.png" alt="ia32-integer-registers.png">
</p>
<p><span class="figure-number">Figure 16: </span>IA32 integer registers</p>
</div>

<ul class="org-ul">
<li>The condition code registers hold status information about the most recently executed arithmetic or logical instruction. These are used to implement conditional changes in the control or data flow, such as is required to implement on the <code>if</code> and <code>while</code> statements.</li>

<li>A set of floating-point registers are used to hold floating-point data.</li>
</ul>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/sizes-of-c-data-types-in-ia32.png" alt="sizes-of-c-data-types-in-ia32.png">
</p>
<p><span class="figure-number">Figure 17: </span>Sizes of C data type in IA32</p>
</div>

<blockquote>
<p>
IA32 doesn't provide hardware support for 64-bit integer arithmetic. Compiling <code>long long</code> data requires generating sequences of operations to perform the arithmetic in 32-bit chunks.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgf62fb71" class="outline-3">
<h3 id="orgf62fb71"><span class="section-number-3">3.4</span> What do you see in the following picture?</h3>
<div class="outline-text-3" id="text-3-4">

<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/ia32-integer-registers.png" alt="ia32-integer-registers.png">
</p>
<p><span class="figure-number">Figure 18: </span>IA32 integer registers</p>
</div>

<ul class="org-ul">
<li>The first six registers can be considered general-purpose registers, with no restriction placed.</li>
<li>The 2 low-order bytes of the first four registers can be used or accessed independently.</li>
<li>When a byte instruction updates one of these single-byte "register elements", the rest three bytes of the register remain unchanged.</li>
</ul>
</div>
</div>

<div id="outline-container-org8e90df1" class="outline-3">
<h3 id="org8e90df1"><span class="section-number-3">3.5</span> What about this one?</h3>
<div class="outline-text-3" id="text-3-5">

<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/operand-forms.png" alt="operand-forms.png">
</p>
<p><span class="figure-number">Figure 19: </span>Operand forms</p>
</div>

<ul class="org-ul">
<li>The first type, <b>immediate</b>, is for constant values, which is written with a <code>$</code> followed by an integer using the standard C notation. Any value that can fits into 32-bit word can be used, although the assembler will use 1- or 2-byte encodings, when possible.</li>
<li>The second type, <b>register</b>, denotes the contents of one of the registers, either one of the eight 32-bit registers (e.g. <code>%eax</code>) for double-word operations, or one of the eight 16-bit registers (e.g. <code>%ax</code>) for single-word operations, or one the eight 8-bit registers (e.g. <code>%al</code>) for byte operations.</li>
<li>The third type, <b>memory</b>, is for memory reference. The last form is the general form, which is often used when referencing elements of arrays. The other forms are simply special cases of the general form.</li>
</ul>
</div>
</div>

<div id="outline-container-org0adaeee" class="outline-3">
<h3 id="org0adaeee"><span class="section-number-3">3.6</span> Some important instructions!</h3>
<div class="outline-text-3" id="text-3-6">

<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/data-movement-instructions.png" alt="data-movement-instructions.png">
</p>
<p><span class="figure-number">Figure 20: </span>Data movement instructions</p>
</div>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/illustration-of-stack-operation.png" alt="illustration-of-stack-operation.png">
</p>
<p><span class="figure-number">Figure 21: </span>Illustration of stack operation</p>
</div>

<p>
By convention, we draw stacks upside down, so that the "top" of the stack is shown at the bottom. IA32 stacks grow toward lower addresses, so pushing involves decrementing the stack pointer (register <code>%esp</code>) and storing to memory, while popping involves reading from memory and incrementing the stack pointer.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/integer-arithmetic-operations.png" alt="integer-arithmetic-operations.png">
</p>
<p><span class="figure-number">Figure 22: </span>Integer arithmetic operations</p>
</div>

<p>
Only <code>leal</code> has no other size. The remaining ones are more standard unary or binary operations. Note the non-intuitive ordering of the operands with ATT-format assembly code.
</p>

<p>
Only right shift requires instructions that differentiate between signed data and unsigned data.
</p>

<p>
In general, compilers generate code that individual registers for multiple program values and moves program values among the registers.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/special-arithmetic-operations.png" alt="special-arithmetic-operations.png">
</p>
<p><span class="figure-number">Figure 23: </span>Special arithmetic operations</p>
</div>

<p>
These operations provide full 64-bit multiplication and division, for both signed and unsigned numbers. <b>*For both of these, one argument must be in register <code>%eax</code>, and the other is given as the instruction source operand. The product is then stored in register <code>%edx</code> (high-order 32-bits) and `%eax` (low-order 32-bits). *</b> Although the name <code>imull</code> is used for two distinct multiplication operations, the assembler can tell which one is intended by counting the number of operands.
</p>

<p>
Some example code:
</p>

<div class="org-src-container">
<pre class="src src-asm">### Divid x by y
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">8</span>(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%edx</span>   # Put x in <span style="color: #a0522d;">%edx</span>
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">%edx</span>, <span style="color: #a0522d;">%eax</span>      # Copy x to <span style="color: #a0522d;">%eax</span>
<span style="color: #0000ff;">sarl</span>  <span style="color: #a020f0;">$31</span>, <span style="color: #a0522d;">%edx</span>       # Sign extend x in <span style="color: #a0522d;">%edx</span>
<span style="color: #0000ff;">idivl</span>     <span style="color: #a020f0;">12</span>(<span style="color: #a0522d;">%ebp</span>)        # Divide by x
# Following the idivl instruction, the quotient and remainder
# are copied to the top two stack location.
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">%eax</span>, 4(<span style="color: #a0522d;">%esp</span>)   # Store x/y
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">%edx</span>, (<span style="color: #a0522d;">%esp</span>)    # Store x<span style="color: #a0522d;">%y</span>


### A more conventional method
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">8</span>(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%edx</span>
<span style="color: #0000ff;">cltd</span>                  # Sign extend into <span style="color: #a0522d;">%edx</span>
<span style="color: #0000ff;">idivl</span>     <span style="color: #a020f0;">12</span>(<span style="color: #a0522d;">%ebp</span>)
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">%eax</span>, 4(<span style="color: #a0522d;">%esp</span>)
<span style="color: #0000ff;">movl</span>  <span style="color: #a020f0;">%edx</span>, (<span style="color: #a0522d;">%esp</span>)

### Unsigned division makes use of the divl instruction. Typically register <span style="color: #a0522d;">%edx</span> is set to 0 beforhand.
</pre>
</div>

<p>
<a href="https://juicyiter.gitee.io/images/condition-codes.png%20" target="_blank" rel="noopener">https://juicyiter.gitee.io/images/condition-codes.png </a>
</p>

<p>
The CPU maintains a set of single-bit <b>condition code</b> registers describing attributes of the <b><b>most recent</b></b> arithmetic or logical operation. Above figure illustrates the most useful condition codes.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/comparison-and-test-instructions.png" alt="comparison-and-test-instructions.png">
</p>
<p><span class="figure-number">Figure 24: </span>Comparison and test instructions</p>
</div>

<p>
The <code>CMP</code>  instructions behave in the same way as the <code>SUB</code> instructions, except that they set the condition codes without changing their destinations.
</p>

<p>
The <code>TEST</code> instructions behave in the same way as the <code>AND</code> instructions, except that they set the condition codes without changing their destinations.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/the-set-instructions.png" alt="the-set-instructions.png">
</p>
<p><span class="figure-number">Figure 25: </span>The SET instructions</p>
</div>

<p>
The <code>SET</code> instructions set a <b><b>single byte</b></b> to 0 or 1 based on some combination of the condition codes. It's important to recognise that the suffix of these instructions denote <b><b>different conditions</b></b> and not different operand sizes.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/imgaes/the-jump-instructions.png" alt="the-jump-instructions.png">
</p>
<p><span class="figure-number">Figure 26: </span>The JUMP instructions</p>
</div>

<p>
In the <b>indirect</b> jump, the jump target is read from the a register or a memory location. When performing PC-relative addressing, the value of the program counter is the address of the instruction following the jump, not that of the jump itself. By using a PC-relative encoding of the jump targets, the instructions can be compactly encoded (requiring just 2 bytes), and the object code can be shifted to different positions in memory without alteration.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/the-conditional-move-instructions.png" alt="the-conditional-move-instructions.png">
</p>
<p><span class="figure-number">Figure 27: </span>The conditional move instructions</p>
</div>

<p>
These instructions copy the source value <b>S</b> to its destination <b>R</b> when the move condition holds.
</p>
</div>
</div>

<div id="outline-container-org2be85e0" class="outline-3">
<h3 id="org2be85e0"><span class="section-number-3">3.7</span> Is there any restrictions when using data move instructions?</h3>
<div class="outline-text-3" id="text-3-7">
<p>
Basically, the source operand designates a <b><b>value</b></b> that is immediate, stored in a register, or stored in a memory, and the destination operand designates a <b><b>location</b></b> that is either a register or a memory. <b><b>But</b></b>, the source operand and the destination operand cannot both referred to a memory. Copying a value from one memory to another requires two instructions‚Äîthe first to load the value into a register, then write this register value to the destination.
</p>
</div>
</div>

<div id="outline-container-orge6badd4" class="outline-3">
<h3 id="orge6badd4"><span class="section-number-3">3.8</span> How can you copy a value from a small location to a larger location?</h3>
<div class="outline-text-3" id="text-3-8">
<p>
<code>movz</code> and <code>movs</code> will do the trick. As you can see from the data movement instructions figure above, in the last two suffixes, the first one always denotes smaller location.
</p>
</div>
</div>

<div id="outline-container-org66a6287" class="outline-3">
<h3 id="org66a6287"><span class="section-number-3">3.9</span> How can you derive the bytes an instruction requires from its 'pattern'?</h3>
<div class="outline-text-3" id="text-3-9">
<p>
The following code shows five possible combinations of source and destination types.
</p>

<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">movl</span> <span style="color: #a020f0;">$0x4050</span>, <span style="color: #a0522d;">%eax</span>                      # Imediate -- Register, 4 bytes
<span style="color: #0000ff;">movw</span> <span style="color: #a020f0;">%bp</span>, <span style="color: #a0522d;">%sp</span>                           # Register -- Register, 2 bytes
<span style="color: #0000ff;">movb</span> (<span style="color: #a0522d;">%edi</span>, <span style="color: #a0522d;">%ecx</span>), <span style="color: #a0522d;">%ah</span>          # Memory -- Register,   1 byte
<span style="color: #0000ff;">movb</span> <span style="color: #a020f0;">$</span>-17, (<span style="color: #a0522d;">%esp</span>)                       # Imediate -- Memory,   1 byte
<span style="color: #0000ff;">movl</span> <span style="color: #a020f0;">%eax</span>, -12(<span style="color: #a0522d;">%ebp</span>)            # Register -- Memory,   4 bytes
</pre>
</div>

<p>
Other instructions which have two operands have the same juice.
</p>

<p>
<code>pop</code> and <code>push</code> instructions take a single operand‚Äîthe data source for pushing and the date destination for popping, which both require a single byte in machine code.
</p>
</div>
</div>

<div id="outline-container-orgc0d8e1b" class="outline-3">
<h3 id="orgc0d8e1b"><span class="section-number-3">3.10</span> Why bother <code>push</code> while you can use <code>sub</code> and <code>mov</code>?</h3>
<div class="outline-text-3" id="text-3-10">
<p>
Push a double-word value to the stack <code>push %ebp</code> requires a single byte.
</p>

<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">subl</span> <span style="color: #a020f0;">$4</span>, <span style="color: #a0522d;">%esp</span>
<span style="color: #0000ff;">movl</span> <span style="color: #a020f0;">%ebp</span>, <span style="color: #a0522d;">%esp</span>
</pre>
</div>
<p>
But the pair of the instructions above require 6 bytes totally, so&#x2026;
</p>

<p>
After <code>pop</code>, the "last top" value remains unchanged until it's overwritten again.
</p>
</div>
</div>

<div id="outline-container-org9c7e6c1" class="outline-3">
<h3 id="org9c7e6c1"><span class="section-number-3">3.11</span> What's wrong with the following code?</h3>
<div class="outline-text-3" id="text-3-11">
<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">movb</span> <span style="color: #a020f0;">$0xF</span>, (<span style="color: #a0522d;">%bl</span>)
<span style="color: #0000ff;">movl</span> <span style="color: #a020f0;">%ax</span>, (<span style="color: #a0522d;">%esp</span>)
<span style="color: #0000ff;">movw</span> (<span style="color: #a0522d;">%eax</span>), 4(<span style="color: #a0522d;">%esp</span>)
<span style="color: #0000ff;">movb</span> <span style="color: #a020f0;">%ah</span>, <span style="color: #a0522d;">%sh</span>
<span style="color: #0000ff;">movl</span> <span style="color: #a020f0;">%eax</span>, $0x123
<span style="color: #0000ff;">movl</span> <span style="color: #a020f0;">%eax</span>, <span style="color: #a0522d;">%dx</span>
<span style="color: #0000ff;">movb</span> <span style="color: #a020f0;">%si</span>, 8(<span style="color: #a0522d;">%ebp</span>)
</pre>
</div>

<ol class="org-ol">
<li>Cannot use <code>%bl</code> as an address register</li>
<li>Mismatch of the data sizes</li>
<li>Cannot have both source and destination operand be memory referrence</li>
<li>No register named <code>%sh</code></li>
<li>Cannot have the destination operand be immediate</li>
<li>Destination operand incorrect size</li>
<li>Mismatch of the data size of the source operand</li>
</ol>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/sample-code-table.png" alt="sample-code-table.png">
</p>
<p><span class="figure-number">Figure 28: </span>Sample code table</p>
</div>

<p>
Recall that when performing a cast that involves both a size change and a change of "signedness" in C, the operation should change the signedness first.
</p>
</div>
</div>

<div id="outline-container-org8e3fac0" class="outline-3">
<h3 id="org8e3fac0"><span class="section-number-3">3.12</span> What is the address of the <code>mov</code> instruction?</h3>
<div class="outline-text-3" id="text-3-12">
<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">XXXXXXX</span>:        <span style="color: #a020f0;">74</span> 12                           je              8048391
<span style="color: #0000ff;">XXXXXXX</span>:        <span style="color: #a020f0;">b8</span> 00 00 00 00          mov             $0x0, <span style="color: #a0522d;">%eax</span>
</pre>
</div>

<p>
Offsets: <code>0x12. 0x91 - 0x12 = 0x7f</code>. So the address of the <code>mov</code> instruction is 804837f and the address of the <code>je</code> instruction is <code>804837d</code> (2 bytes).
</p>
</div>
</div>

<div id="outline-container-orgb49468b" class="outline-3">
<h3 id="orgb49468b"><span class="section-number-3">3.13</span> What is the relationship between the annotation on the right and the byte coding on the left?</h3>
<div class="outline-text-3" id="text-3-13">
<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">80482aa</span>:        <span style="color: #a020f0;">ff</span> 25 fc 9f 04 08       jmp             *0x8049ffc
</pre>
</div>

<p>
The first two bytes denote the instruction <code>jmp</code>, and this is an indirect jump, where the following 4 bytes are the jump location. And it's a little endian machine.
</p>
</div>
</div>

<div id="outline-container-org36862ba" class="outline-3">
<h3 id="org36862ba"><span class="section-number-3">3.14</span> What is the address of the jump target?</h3>
<div class="outline-text-3" id="text-3-14">
<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">80482bf</span>:        <span style="color: #a020f0;">e9</span> e0 ff ff ff          jmp             XXXXXXX
<span style="color: #0000ff;">80482c4</span>:        <span style="color: #a020f0;">90</span>                                      nop
</pre>
</div>

<p>
Note: In the code above, the jump target is encoded in PC-relative form as a 4-byte, two's-complement number. The bytes are listed from the least significant to most, reflecting the little-endian byte ordering of IA32.
</p>

<p>
Reading the bytes in reverse order, you can see that the target offset is <code>0xffffffe0</code>, or decimal -32. Adding this to <code>0x80482c4</code> gives the address <code>0x80482a4</code>.
</p>
</div>
</div>

<div id="outline-container-org3697abe" class="outline-3">
<h3 id="org3697abe"><span class="section-number-3">3.15</span> Why the assembly code contains two conditional branches, even though the C code has only one <code>if</code> statement?</h3>
<div class="outline-text-3" id="text-3-15">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">void</span> <span style="color: #0000ff;">cond</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">a</span>, <span style="color: #228b22;">int</span> *<span style="color: #a0522d;">p</span>)
{
    <span style="color: #a020f0;">if</span> (p &amp;&amp; a&gt;0)
        *p += a;
}
</pre>
</div>

<p>
Assembly code:
</p>
<div class="org-src-container">
<pre class="src src-asm"># a <span style="color: #a0522d;">%ebp</span>+8, p at <span style="color: #a0522d;">%ebp</span>+12
        <span style="color: #a020f0;">movl</span>    8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%edx</span>
        <span style="color: #a020f0;">movl</span>    12(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%eax</span>
        <span style="color: #a020f0;">testl</span>   <span style="color: #a0522d;">%eax</span>, <span style="color: #a0522d;">%eax</span>
        <span style="color: #a020f0;">je</span>              .L3
        <span style="color: #a020f0;">testl</span>   <span style="color: #a0522d;">%edx</span>, <span style="color: #a0522d;">%edx</span>
        <span style="color: #a020f0;">jle</span>             .L3
        <span style="color: #a020f0;">addl</span>    <span style="color: #a0522d;">%edx</span>, (<span style="color: #a0522d;">%eax</span>)
<span style="color: #0000ff;">.L3</span>:
</pre>
</div>

<p>
The first conditional branch is part of the implementation of the <code>&amp;&amp;</code> expression. If the test for <code>p</code> being non-null fails, the code will skip the test of <code>a&gt;0</code>.
</p>
</div>
</div>

<div id="outline-container-orge52ef63" class="outline-3">
<h3 id="orge52ef63"><span class="section-number-3">3.16</span> How the compilers generate loop code?</h3>
<div class="outline-text-3" id="text-3-16">
<p>
Most compilers generate loop code based on the <code>do-while</code> form of a loop, even though this form is relatively uncommon in actual programs. Other forms of loops are transformed into <code>do-while</code> from and then compiled into machine code.
</p>
</div>
</div>

<div id="outline-container-org4888d24" class="outline-3">
<h3 id="org4888d24"><span class="section-number-3">3.17</span> Why can code based on <b>conditional data transfer</b> outperform code based on conditional control transfer?</h3>
<div class="outline-text-3" id="text-3-17">
<p>
Processors achieve high performance through <b>pipelining</b>, where an instruction is processed via a sequence of stages, each performing one small portion of the required operations (e.g. fetching the instructions from memory, determining the instruction type, reading from memory, and updating the program counter). This approach achieves high performance by <b><b>overlapping the steps of the successive instructions</b></b>, such as fetching one instruction while performing the arithmetic operations for a previous instruction. Processor employ sophisticated <b>branch prediction logic</b> to try to guess whether or not each jump instruction will be followed. Mispredicting, on the other hand, requires that the processor <b><b>discard</b></b> much of the work it has already done on future instructions and then begin filling the pipeline with instructions starting at the correct location.
</p>
</div>
</div>

<div id="outline-container-org4deb9f0" class="outline-3">
<h3 id="org4deb9f0"><span class="section-number-3">3.18</span> What's the differences between <code>jmp</code>, <code>set</code> and <code>cmov</code> ?</h3>
<div class="outline-text-3" id="text-3-18">
<p>
The outcomes of <code>cmov</code> instructions depends on the value of the conditional codes. The source value is read from either memory or the source register, but it is copied to the destination only if the specified condition holds.
</p>

<p>
Unlike the traditional jump moves, the processor can execute conditional move without having to predict the outcome of the test.
</p>
</div>
</div>

<div id="outline-container-org3e55b4a" class="outline-3">
<h3 id="org3e55b4a"><span class="section-number-3">3.19</span> What the peculiarities of  the conditional move are?</h3>
<div class="outline-text-3" id="text-3-19">
<p>
Single byte conditional moves are not supported. The assembly can infer the operand length of a conditional move instruction from the name of the destination register, and so the same instruction can be used for all operand lengths.
</p>
</div>
</div>

<div id="outline-container-org5cb6f62" class="outline-3">
<h3 id="org5cb6f62"><span class="section-number-3">3.20</span> How conditional operations can be implemented via conditional data transfers?</h3>
<div class="outline-text-3" id="text-3-20">
<p>
Consider the following code:
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">arith</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>)
{
    <span style="color: #a020f0;">return</span> x/4;
}
</pre>
</div>

<p>
When compiled, GCC generates the following assembly code:
</p>

<div class="org-src-container">
<pre class="src src-asm"># register: x in <span style="color: #a0522d;">%edx</span>

<span style="color: #0000ff;">leal</span>    <span style="color: #a020f0;">3</span>(<span style="color: #a0522d;">%edx</span>), <span style="color: #a0522d;">%eax</span>   # temp = x+3
<span style="color: #0000ff;">testl</span>   <span style="color: #a020f0;">%edx</span>, <span style="color: #a0522d;">%edx</span>              # Test x
<span style="color: #0000ff;">cmovns</span>  <span style="color: #a020f0;">%edx</span>, <span style="color: #a0522d;">%eax</span>              # If &gt;= 0, temp = x
<span style="color: #0000ff;">sarl</span>    <span style="color: #a020f0;">$2</span>, <span style="color: #a0522d;">%eax</span>                # Return value in <span style="color: #a0522d;">%eax</span>
</pre>
</div>

<p>
The program creates a temporary value equal to <code>x+3</code>, in anticipation of <code>x</code> being negative, and therefore requiring <b><b>biasing</b></b>. The `cmovns` instructions conditionally changes the number to <code>x</code>, when <code>x&gt;=0</code>, and then it is shifted by 2 to generate <code>x/4</code>;
</p>

<p>
The source code can be described by following code:
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">arith</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>)
{
    bias = x+3;
    <span style="color: #a020f0;">if</span>(x&lt;0) x = bias;
    <span style="color: #a020f0;">return</span> x&gt;&gt;2;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org31909a6" class="outline-3">
<h3 id="org31909a6"><span class="section-number-3">3.21</span> Heads up: JUMP TABLE</h3>
<div class="outline-text-3" id="text-3-21">
<p>
A jump table is an array where entry <code>i</code> is the address of a code segment implementing the action the program should take when the switch index equals <code>i</code>.
</p>

<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">jmp</span>             *.L7(, <span style="color: #a0522d;">%eax</span>, 4)
</pre>
</div>

<p>
In the assembly code above, the <code>jmp</code> instruction's operand is prefixed with <code>*</code>, indicating <b><b>indirect jump</b></b>, and the operand specifies a memory location indexed by register <code>%eax</code>, which holds the value of <code>index</code>.
</p>

<p>
The jump table:
</p>
<div class="org-src-container">
<pre class="src src-asm"><span style="color: #a020f0;">.section</span>                .rodata         # Read-only data
        <span style="color: #a020f0;">.align</span> 4                                        # Align address to multiple of 4
<span style="color: #0000ff;">.L7</span>:
        <span style="color: #a020f0;">.long</span>   .L3                                     # Case one: .L3
        <span style="color: #a020f0;">.long</span>   .L2
        <span style="color: #a020f0;">.long</span>   .L4
        <span style="color: #a020f0;">.long</span>   .L5
</pre>
</div>

<p>
Label <code>.L7</code> marks the start of this allocation. The address associated with this label serves as the base for the indirect jump.
</p>
</div>
</div>

<div id="outline-container-org2a230b1" class="outline-3">
<h3 id="org2a230b1"><span class="section-number-3">3.22</span> Consider the following code and answer what the values are of the case labels in the `switch` statement body.</h3>
<div class="outline-text-3" id="text-3-22">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">switch2</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">result</span> = 0;
    <span style="color: #a020f0;">switch</span>(x)
    {
            <span style="color: #b22222;">/* </span><span style="color: #b22222;">body of switch statement omitted </span><span style="color: #b22222;">*/</span>
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-asm"># x at <span style="color: #a0522d;">%ebp</span>+8
        <span style="color: #a020f0;">movl</span>    8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%eax</span>
        # Set up jump table access
        <span style="color: #a020f0;">addl</span>    $2, <span style="color: #a0522d;">%eax</span>
        <span style="color: #a020f0;">cmpl</span>    $6, <span style="color: #a0522d;">%eax</span>
        <span style="color: #a020f0;">ja</span>              .L2
        <span style="color: #a020f0;">jmp</span>             *.L8(, <span style="color: #a0522d;">%eax</span>, 4)
        ...

        # Jump table for switch2
        <span style="color: #a020f0;">.L8</span>:
                <span style="color: #a020f0;">.long</span>   .L3
                <span style="color: #a020f0;">.long</span>   .L2
                <span style="color: #a020f0;">.long</span>   .L4
                <span style="color: #a020f0;">.long</span>   .L5
                <span style="color: #a020f0;">.long</span>   .L6
                <span style="color: #a020f0;">.long</span>   .L6
                <span style="color: #a020f0;">.long</span>   .L7
</pre>
</div>

<p>
Compare <code>x+2</code> and <code>6</code>, so the possible values are: <code>-2, -1, 0, 1, 2, 3, 4</code>. But the <code>.L2</code> is used to return, so <code>0</code> is missing. Hence, the values are: <code>-2, -1, 1, 2, 3, 4</code>. Besides, case <code>.L6</code> has two labels in C.
</p>
</div>
</div>

<div id="outline-container-org667acd8" class="outline-3">
<h3 id="org667acd8"><span class="section-number-3">3.23</span> Procedures</h3>
<div class="outline-text-3" id="text-3-23">
<p>
The most important features <b><b>in IA32</b></b> when handling procedure calls is <b><b><b>stack frame structure</b></b></b>.
</p>
</div>
<div id="outline-container-org943f78e" class="outline-4">
<h4 id="org943f78e"><span class="section-number-4">3.23.1</span> So what is a stack frame structure?</h4>
<div class="outline-text-4" id="text-3-23-1">
<p>
A stack frame is the portion of the stack allocated for <b><b>a single</b></b> procedure call, which means every procedure call has a stack frame pointer. See more at the following picture.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/stack-frame-structure.png" alt="stack-frame-structure.png">
</p>
<p><span class="figure-number">Figure 29: </span>Stack frame structure</p>
</div>

<p>
The register <code>%ebp</code> serves as the frame pointer, and the register <code>%esp</code> serves as the stack pointer. The stack pointer moves (<b><b>in IA32</b></b>) while the procedures is executing and <b><b>most information is accessed relative to the stack pointer</b></b>. Also, note that <b>*the *return address</b> within caller** where the program should resume execution when it returns from callee <b><b>is pushed onto the stack</b></b>.
</p>
</div>
</div>

<div id="outline-container-orga77ce9f" class="outline-4">
<h4 id="orga77ce9f"><span class="section-number-4">3.23.2</span> Transferring control</h4>
<div class="outline-text-4" id="text-3-23-2">

<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/illustration-of-call-and-ret-functions.png" alt="illustration-of-call-and-ret-functions.png">
</p>
<p><span class="figure-number">Figure 30: </span>Illustration of <code>call</code> and <code>ret</code> functions</p>
</div>

<p>
The above figure is to illustrate the execution of the <code>call</code> and <code>ret</code> instructions for the following functions:
</p>

<div class="org-src-container">
<pre class="src src-asm"># Beginning of function sum
<span style="color: #0000ff;">08048394</span>  &lt;sum&gt;:
 <span style="color: #a020f0;">8048394</span>:       55                                      push    <span style="color: #a0522d;">%ebp</span>
...
# Return from function sum

 <span style="color: #a020f0;">80483a4</span>:       c3                                      ret
...

# Call to sum from main
 <span style="color: #a020f0;">80483dc</span>:       e8 b3 ff ff ff          call    8048394 &lt;sum&gt;
 <span style="color: #a020f0;">80483e1</span>:   83 c4 14                    add             $0x14, <span style="color: #a0522d;">%esp</span>
</pre>
</div>

<p>
The effect of a <code>call</code> instruction is to <b><b>push a return address(<code>0x080483e1</code>) on the stack</b></b> and <b><b>jump to the start of the called procedure**(<code>0x08048394</code>). The return address is the address of the instruction **immediately following the <code>call</code> in the program</b></b>, so that execution will resume at this location when the called procedure returns. The <code>ret</code> instruction <b><b>pops an address off the stack(`0x080483e1`) and jumps to this location.</b></b>
</p>

<p>
n conclusion, the <code>call</code> instruction transfers control to the start of a function, while the  <code>ret</code> instruction returns back to the instruction following the call.
</p>

<blockquote>
<p>
Register <code>%eax</code> (in IA32) is used for returning the value from any function that returns an <b><b>integer or pointer</b></b>.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org0012665" class="outline-4">
<h4 id="org0012665"><span class="section-number-4">3.23.3</span> Some register usage conventions</h4>
<div class="outline-text-4" id="text-3-23-3">
<p>
<b><b>Caller-save</b></b> registers: <code>%eax</code>, <code>%edx</code> and <code>%ecx</code>. When a caller procedure P calls a callee procedure Q, Q can overwrite these registers without destroying any date required by P.
</p>

<p>
<b><b>Callee-save</b></b> registers: <code>%ebx</code>, <code>%esi</code> and <code>%edi</code>. Q must <b><b>save</b></b> the values of these registers on the stack before overwriting them, and <b><b>restore</b></b> them before returning, because the P may need these values for its future use(like recursive procedures).
</p>
</div>
</div>

<div id="outline-container-org8a8d44c" class="outline-4">
<h4 id="org8a8d44c"><span class="section-number-4">3.23.4</span> Example codes</h4>
<div class="outline-text-4" id="text-3-23-4">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">swap_add</span>(<span style="color: #228b22;">int</span> *<span style="color: #a0522d;">xp</span>, <span style="color: #228b22;">int</span> *<span style="color: #a0522d;">yp</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">x</span> = *xp;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span> = *yp;

    *xp = y;
    *yp = x;
    <span style="color: #a020f0;">return</span> x + y;
}
<span style="color: #228b22;">int</span> <span style="color: #0000ff;">caller</span>()
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">arg1</span> = 534;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">arg2</span> = 1057;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">sum</span> = swap_add(&amp;arg1, &amp;arg2);
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">diff</span> = arg1 - arg2;

    <span style="color: #a020f0;">return</span> sum * dif;
}
</pre>
</div>

<p>
The following assembly code shows the compiled version of <code>caller</code> and <code>swap_add</code>:
</p>
<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">caller</span>:
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebp</span>                            # Save old <span style="color: #a0522d;">%ebp</span>
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%esp</span>, <span style="color: #a0522d;">%ebp</span>                      # Set <span style="color: #a0522d;">%ebp</span> as frame pointer
  <span style="color: #a020f0;">subl</span>          $24, <span style="color: #a0522d;">%esp</span>                       # Allocate 24 bytes on stack
  <span style="color: #a020f0;">movl</span>          $534, -4(<span style="color: #a0522d;">%ebp</span>)          # Set arg1 to 534
  <span style="color: #a020f0;">movl</span>          $1057, -8(<span style="color: #a0522d;">%ebp</span>)         # Set arg2 to 1057
  <span style="color: #a020f0;">leal</span>          -8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%eax</span>          # Compute &amp;arg2
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%eax</span>, 4(<span style="color: #a0522d;">%esp</span>)           # Store on stack
  <span style="color: #a020f0;">leal</span>          -4(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%eax</span>          # Compute &amp;arg1
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%eax</span>, (<span style="color: #a0522d;">%esp</span>)            # Store on stack
  <span style="color: #a020f0;">call</span>          swap_add                        # Call the swap_add function
  <span style="color: #a020f0;">movl</span>          -4(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%edx</span>          # Get arg1
  <span style="color: #a020f0;">subl</span>          -8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%edx</span>          # Compute arg1 - arg2
  <span style="color: #a020f0;">imull</span>         <span style="color: #a0522d;">%edx</span>, <span style="color: #a0522d;">%eax</span>                      # Compute sum * diff
  <span style="color: #a020f0;">leave</span>                                                 # Deallocate a stack frame
  <span style="color: #a020f0;">ret</span>

<span style="color: #0000ff;">swap_add</span>:
  # Setup code
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebp</span>                            # Save old <span style="color: #a0522d;">%ebp</span>
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%esp</span>, <span style="color: #a0522d;">%ebp</span>                      # Set <span style="color: #a0522d;">%ebp</span> as frame pointer
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebx</span>                            # Save <span style="color: #a0522d;">%ebx</span>
  # Body code
  <span style="color: #a020f0;">movl</span>          8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%edx</span>           # Get xp
  <span style="color: #a020f0;">movl</span>          12(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%ecx</span>          # Get yp
  <span style="color: #a020f0;">movl</span>          (<span style="color: #a0522d;">%edx</span>), <span style="color: #a0522d;">%ebx</span>            # Get x
  <span style="color: #a020f0;">movl</span>          (<span style="color: #a0522d;">%ecx</span>), <span style="color: #a0522d;">%eax</span>            # Get y
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%eax</span>, (<span style="color: #a0522d;">%edx</span>)            # Store y at xp
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%ebx</span>, (<span style="color: #a0522d;">%ecx</span>)            # Store x at yp
  <span style="color: #a020f0;">addl</span>          <span style="color: #a0522d;">%ebx</span>, <span style="color: #a0522d;">%eax</span>                      # Return value = x+y
  # Finishing code
  <span style="color: #a020f0;">popl</span>          <span style="color: #a0522d;">%ebx</span>                            # Restore <span style="color: #a0522d;">%ebx</span>
  <span style="color: #a020f0;">popl</span>          <span style="color: #a0522d;">%ebp</span>                            # Restore <span style="color: #a0522d;">%ebp</span>
  <span style="color: #a020f0;">ret</span>                                                   # Return
</pre>
</div>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/stack-frame-for-caller-and-swap-add.png" alt="stack-frame-for-caller-and-swap-add.png">
</p>
<p><span class="figure-number">Figure 31: </span>Stack frame for <code>caller</code> and <code>swap_add</code></p>
</div>
</div>
</div>

<div id="outline-container-org9e58f9e" class="outline-4">
<h4 id="org9e58f9e"><span class="section-number-4">3.23.5</span> Why does GCC allocate space that never gets used?</h4>
<div class="outline-text-4" id="text-3-23-5">
<p>
We see that the code generated by GCC for <code>caller</code> allocates 24 bytes on the stack even though it only makes use of 16 of them. Why is that?
</p>

<p>
GCC adheres to an x86 programming guideline that the <b><b>total stack space used by the function</b></b> should be a multiple of 16 bytes. Including 4 bytes for the saved value of <code>%ebp</code> and the 4 bytes for the return address, <code>caller</code> uses a total of 32 bytes.
</p>
</div>
</div>

<div id="outline-container-org4e67553" class="outline-4">
<h4 id="org4e67553"><span class="section-number-4">3.23.6</span> Recursive procedures</h4>
<div class="outline-text-4" id="text-3-23-6">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">rfact</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">n</span>)
{
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">result</span>;
    <span style="color: #a020f0;">if</span>(n &lt;= 1)
        <span style="color: #a020f0;">return</span> 1;
    <span style="color: #a020f0;">else</span>
        result = n * rfact(n-1);
    <span style="color: #a020f0;">return</span> result;
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-asm"># Argument: n at <span style="color: #a0522d;">%ebp</span>+8
# Registers: n in <span style="color: #a0522d;">%ebx</span>, result in <span style="color: #a0522d;">%eax</span>
<span style="color: #0000ff;">rfact</span>:
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebp</span>                            # Save old <span style="color: #a0522d;">%ebp</span>
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%esp</span>, <span style="color: #a0522d;">%ebp</span>
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebx</span>                            # Save callee save register <span style="color: #a0522d;">%ebx</span>
  <span style="color: #a020f0;">subl</span>          $4, <span style="color: #a0522d;">%esp</span>
  <span style="color: #a020f0;">movl</span>          8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%ebx</span>
  <span style="color: #a020f0;">movl</span>          $1, <span style="color: #a0522d;">%eax</span>
  <span style="color: #a020f0;">cmpl</span>          $1, <span style="color: #a0522d;">%ebx</span>
  <span style="color: #a020f0;">jle</span>           .L53
  <span style="color: #a020f0;">leal</span>          -1(<span style="color: #a0522d;">%ebx</span>), <span style="color: #a0522d;">%eax</span>
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%eax</span>, (<span style="color: #a0522d;">%esp</span>)
  <span style="color: #a020f0;">call</span>          rfact
  <span style="color: #a020f0;">imull</span>         <span style="color: #a0522d;">%ebx</span>, <span style="color: #a0522d;">%eax</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd1063ce" class="outline-3">
<h3 id="orgd1063ce"><span class="section-number-3">3.24</span> Array allocation and access</h3>
<div class="outline-text-3" id="text-3-24">
<p>
GCC allocates 12 bytes(16 bytes in x86<sub>64</sub>) for the <code>long double</code> format, even though it only requires 10 bytes.
</p>

<p>
The <code>leal</code> instruction is used to generate an address, while <code>movl</code> is used to reference memory.
</p>
</div>
</div>

<div id="outline-container-org6916c6e" class="outline-3">
<h3 id="org6916c6e"><span class="section-number-3">3.25</span> Heterogeneous data structures</h3>
<div class="outline-text-3" id="text-3-25">
<p>
Consider the following declarations:
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #a020f0;">struct</span> <span style="color: #228b22;">S3</span>{
    <span style="color: #228b22;">char</span> <span style="color: #a0522d;">c</span>;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>[2];
    <span style="color: #228b22;">double</span> <span style="color: #a0522d;">v</span>;
};
<span style="color: #a020f0;">union</span> <span style="color: #228b22;">U3</span>{
    <span style="color: #228b22;">char</span> <span style="color: #a0522d;">c</span>;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>[2];
    <span style="color: #228b22;">double</span> <span style="color: #a0522d;">v</span>;
};
</pre>
</div>

<p>
When complied on an IA32 Linux machine, the offsets of the fields, as well as the total size of data types <code>S3</code> and <code>U3</code>, are as shown in the following figure:
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/struct-and-union-alignment.png" alt="struct-and-union-alignment.png">
</p>
<p><span class="figure-number">Figure 32: </span>Struct and union alignment</p>
</div>
</div>

<div id="outline-container-org3848815" class="outline-4">
<h4 id="org3848815"><span class="section-number-4">3.25.1</span> Why <code>i</code> has offset 4 in <code>S3</code> rather than 1?</h4>
<div class="outline-text-4" id="text-3-25-1">
<p>
For code involving structures, the compiler may need to <b><b>insert gaps</b></b> in the field allocation to ensure that each structure element satisfies its alignment requirement.
</p>

<blockquote>
<p>
Linux follows an alignment policy where 2-byte data types (e.g. <code>short</code>) must have an address that is a multiple of 2, while any larger data types (e.g. <code>int</code>, <code>int *</code>, <code>float</code>, and <code>double</code>) must have an address that is a multiple of 4.  This requirement means that the least significant bit or low-order 2 bits of the address of the object must equal zero.
</p>

<p>
Most computer systems requires that the address for some type of object must be a multiple of some value K (typically 2, 4, or 8). Such alignment restrictions simplify the design of the hardware forming the interface between the processor and the memory system.
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org8d154e2" class="outline-3">
<h3 id="org8d154e2"><span class="section-number-3">3.26</span> What happend after buffer overflow?</h3>
<div class="outline-text-3" id="text-3-26">
<p>
Consider the following C code:
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">void</span> <span style="color: #0000ff;">echo</span>()
{
    <span style="color: #228b22;">char</span> <span style="color: #a0522d;">buf</span>[8];        <span style="color: #b22222;">/* </span><span style="color: #b22222;">Way too small </span><span style="color: #b22222;">*/</span>
    gets(buf);
    puts(buf);
}
</pre>
</div>

<p>
And the assembly code generated by GCC:
</p>

<div class="org-src-container">
<pre class="src src-asm"><span style="color: #0000ff;">echo</span>:
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebp</span>                    # Save <span style="color: #a0522d;">%ebp</span>
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%esp</span>, <span style="color: #a0522d;">%ebp</span>              # Frame pointer
  <span style="color: #a020f0;">pushl</span>         <span style="color: #a0522d;">%ebx</span>                    # Save <span style="color: #a0522d;">%ebx</span>
  <span style="color: #a020f0;">subl</span>          $20, <span style="color: #a0522d;">%esp</span>               # Allocate 20 bytes
  <span style="color: #a020f0;">leal</span>          -12(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%ebx</span> # Compute buf as <span style="color: #a0522d;">%ebp</span> - 12
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%ebx</span>, (<span style="color: #a0522d;">%esp</span>)    # Store buf at top of stack
  <span style="color: #a020f0;">call</span>          gets                    # Call gets
  <span style="color: #a020f0;">movl</span>          <span style="color: #a0522d;">%ebx</span>, (<span style="color: #a0522d;">%esp</span>)    # Store buf at top of stack
  <span style="color: #a020f0;">call</span>          puts                    # Call puts
  <span style="color: #a020f0;">addl</span>          $20, <span style="color: #a0522d;">%esp</span>               # Deallocate
  <span style="color: #a020f0;">popl</span>          <span style="color: #a0522d;">%edx</span>                    # Restore
  <span style="color: #a020f0;">popl</span>          <span style="color: #a0522d;">%ebp</span>                    # Restore
  <span style="color: #a020f0;">ret</span>
</pre>
</div>
<p>
And the stack organization for <code>echo</code> function.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/stack-organization.png" alt="stack-organization.png">
</p>
<p><span class="figure-number">Figure 33: </span>Stack organization for <code>echo</code> function</p>
</div>

<p>
A long string will cause the <code>gets</code> to overwrite some of the information stored on the stack.
</p>

<p>
The corruption is cumulative‚Äîas the number of the characters increases, more state gets corrupted.
</p>
</div>
</div>

<div id="outline-container-org33bfd3e" class="outline-3">
<h3 id="org33bfd3e"><span class="section-number-3">3.27</span> Three ways to thwart buffer overflow</h3>
<div class="outline-text-3" id="text-3-27">
</div>
<div id="outline-container-orgb7670b5" class="outline-4">
<h4 id="orgb7670b5"><span class="section-number-4">3.27.1</span> Stack randomization</h4>
<div class="outline-text-4" id="text-3-27-1">
<p>
This is implemented by allocating a random amount of space between 0 and n bytes on the stack at the start of a program, for example, by using the allocation function <code>alloca</code>, which allocates space for a specified number of bytes on the stack.
</p>

<p>
It's one of a larger class of techniques known as <b>address-space layout randomization</b>, or ALSR. With ALSR, different parts of the program, including program code, library code, stack, global variables, and heap data, are loaded into different regions of memory each time a program is run.
</p>
</div>
</div>
<div id="outline-container-orgb3a14ec" class="outline-4">
<h4 id="orgb3a14ec"><span class="section-number-4">3.27.2</span> Stack corruption detection</h4>
<div class="outline-text-4" id="text-3-27-2">
<p>
The idea is to store a special <b><b>canary value</b></b> in the stack frame between any local buffer and the rest of the stack state, as illustrated in the following figure.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/stack-corruption-detection.png" alt="stack-corruption-detection.png">
</p>
<p><span class="figure-number">Figure 34: </span>Stack organization for <code>echo</code> function with stack protector enabled</p>
</div>

<p>
The canary value, also referred to as a <b>guard value</b>, is generated randomly each time the program is run, so there is no easy way for an attacker to determine what it is.
</p>

<p>
The modified assembly code is as follow:
</p>
<div class="org-src-container">
<pre class="src src-asm">...
  <span style="color: #a020f0;">subl</span>  $20, <span style="color: #a0522d;">%esp</span>
  <span style="color: #a020f0;">movl</span>  <span style="color: #a0522d;">%gs</span>:20, <span style="color: #a0522d;">%eax</span>                    # Retrieve canary
  <span style="color: #a020f0;">movl</span>  <span style="color: #a0522d;">%eax</span>, -8(<span style="color: #a0522d;">%ebp</span>)                  # Store on stack
  <span style="color: #a020f0;">xorl</span>  <span style="color: #a0522d;">%eax</span>, <span style="color: #a0522d;">%eax</span>                              # Zero out register
  <span style="color: #a020f0;">leal</span>  -16(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%ebx</span>
  ...
  <span style="color: #a020f0;">movl</span>  -8(<span style="color: #a0522d;">%ebp</span>), <span style="color: #a0522d;">%eax</span>                  # Retrieve canary
  <span style="color: #a020f0;">xorl</span>  <span style="color: #a0522d;">%gs</span>:20, <span style="color: #a0522d;">%eax</span>                    # Compare to stored value
  <span style="color: #a020f0;">je</span>    .L19
  <span style="color: #a020f0;">call</span>  __stack_chk_fail                # Stack corrupted!
 <span style="color: #a020f0;">.L19</span>:
  <span style="color: #a020f0;">addl</span>  $20, <span style="color: #a0522d;">%esp</span>                               # Normal return
  ...
</pre>
</div>
<p>
The instruction argument <code>%gs:20</code> is an instruction that the canary value is read from memory using <b><b><b>Segment addressing</b></b></b>, an addressing mechanism that dates back to the 80286 and is seldom found in programs running on modern systems. By storing the canary value in a special segment, it can be marked as <b><b>read only</b></b>.
</p>
</div>
</div>

<div id="outline-container-org4303f8f" class="outline-4">
<h4 id="org4303f8f"><span class="section-number-4">3.27.3</span> Limiting executable code regions</h4>
<div class="outline-text-4" id="text-3-27-3">
<p>
This method is to limit which regions hold executable code. Historically, the x86 architecture merged the read and execute access controls into a single 1-bit flag, so that any page marked as readable was also executable. The stack had to be kept both readable and writable, and therefore the bytes on the stack were also executable.
</p>

<p>
AMD introduced an "NX" (for "no-executa") bit into the memory protextion for its 64-bit processors, seperating the read and execute acess modes, and Intel followed suit. With this feature, the stack can be marked as being readable and writable, but not executable, and the checking of whether a page is executable is performed in hardware, with no penalty in efficiency.
</p>
</div>
</div>
</div>

<div id="outline-container-org946827e" class="outline-3">
<h3 id="org946827e"><span class="section-number-3">3.28</span> Some of the key differences between IA32 and x86-64</h3>
<div class="outline-text-3" id="text-3-28">
<ul class="org-ul">
<li><code>movq</code> in x86-64, <code>movl</code> in IA32. The <b><b>pointers</b></b> and variables declared as <code>long</code> integers are 64 bits (<b><b>quad words</b></b>) in x86-64 rather than 32 bits (long words) in IA32.</li>

<li><p>
The number of registers has been double to 16 64-bit versions of registers. The procedure returns a value by storing it in register <code>%rax</code>. The lower-order 32 bits, 16 bits and 8 bits of each register can be accessed directly in x86-64.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/64-bit-integer-registers.png" alt="64-bit-integer-registers.png">
</p>
<p><span class="figure-number">Figure 35: </span>64-bit integer registers</p>
</div></li>

<li>No stack frame gets generated in the x86-64 version. <code>%ebp</code> is available for use as a general-purpose register.</li>

<li>Arguments are passed in <b><b>6 argument registers</b></b> respectively.</li>

<li>With x86-64, the program counter is named for <code>%rip</code>.</li>

<li><p>
New instruction <code>movabsq</code>.
</p>


<div class="figure">
<p><img src="https://juicyiter.gitee.io/images/64-bit-data-movement-instructions.png" alt="64-bit-data-movement-instructions.png">
</p>
<p><span class="figure-number">Figure 36: </span>64-bit data movement instructions</p>
</div>

<blockquote>
<p>
The <code>movabsq</code> instruction <b>*only allows immediate data (show as *I</b>) as the source value**.
</p>
</blockquote></li>

<li><p>
<code>movl</code> and <code>addl</code> instructions in x86-64 will set upper 32 bits of the destination register to zero. Instructions that generate 16-bit results , such as <code>addw</code>, only affect ther 16-bit destination registers, and similarly for instructions that generate 8-bit results. As with the <code>movq</code> instruction, <b><b>immediate operands are limited to 32-values</b></b>, which are sign extend to 64 bits.
</p>


<div class="figure">
<p><img src="http://juicyiter.gitee.io/images/64-bit-special-arithmetic-operations.png" alt="64-bit-special-arithmetic-operations.png">
</p>
<p><span class="figure-number">Figure 37: </span>64-bit special arithmetic operations</p>
</div>

<blockquote>
<p>
<code>cltq</code> is equivalent to <code>movslq</code>.
</p>
</blockquote></li>

<li>Special instruction <code>rep</code> in x86-64. It is normally used to implement a repeating string operation to avoid making the <code>ret</code> instruction be the destination of a conditional jump instruction. It serves as a form of no-operation here to make the code faster on AMD processors.</li>

<li><p>
Basicly, arguments are passed to procedures via registers rather than stack. But there are few cases when the stack frame is needed:
</p>

<ul class="org-ul">
<li>Too many local variables.</li>
<li>Some local variables are arrays or structures.</li>
<li>The function uses the address-of operator (&amp;) to compute the address of a local variable.</li>
<li>The function must pass some arguments on the stack to another function.</li>
<li>The function needs to save the state of a callee-save register before modifying it.</li>
</ul>

<p>
The stack frames for x86-64 procedures usually have a fixed size, set at the beginning of the procedure by decrementing the stack pointer (<code>%rsp</code>). <b><b>The stack pointer remains at a fixed size during the call</b></b>, making it possible to acess data using offsets relative to the stack pointer, so the frame pointer is no longer needed.
</p></li>

<li>The <code>callq</code> instruction stores a 64-bit return address on the stack.</li>

<li>Being able to access memory <b><b>beyond the stack pointer</b></b> in x86-64. It's an unusual feature. The x86-64 ABI specifies that programs can use <b><b>128 bytes beyond</b></b> the current stack pointer. This area is referred to as the <b>red zone</b>. It must be kept available for reading and writing as the stack pointer moves.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: <a href="https://mengoreo.github.io">Ethan Mengoreo</a>
<a href="https://github.com/mengoreo" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i></a></p>
<p class="postamble">Last Updated 2019-04-08 Mon 13:39.</p>
</div>
</body>
</html>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  
    <div id="gitalk-container"></div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Mengoreo" />
            
              <p class="site-author-name" itemprop="name">Mengoreo</p>
              <p class="site-description motion-element" itemprop="description">Be yourself & Beyond yourself</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/mengoreo" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:mengoreo@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/mengoreo" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">1.</span> <span class="nav-text">Computer System: A Programming Perspective</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">1.1.</span> <span class="nav-text">Table of Contents</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org40301da"><span class="nav-number">1.2.</span> <span class="nav-text">1 A tour</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#orge4eb835"><span class="nav-number">1.3.</span> <span class="nav-text">2 Representing and Manipulating Information</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#org1839ff5"><span class="nav-number">1.3.1.</span> <span class="nav-text">2.1 Information Storage</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org470f386"><span class="nav-number">1.3.2.</span> <span class="nav-text">2.2 Integer Representations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org7e52d48"><span class="nav-number">1.3.3.</span> <span class="nav-text">2.3 Integer Arithmetic</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#orgf0bb3bf"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">2.3.1 Unsigned Addition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org216999c"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">2.3.2 Unsigned Negation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org54c1d8b"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">2.3.3 Unsigned Multiplication</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org7c746d8"><span class="nav-number">1.3.3.4.</span> <span class="nav-text">2.3.4 Two&#39;s Complement Additon</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org93ec3d0"><span class="nav-number">1.3.3.5.</span> <span class="nav-text">2.3.5 Two&#39;s Complement Negation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org84cefe0"><span class="nav-number">1.3.3.6.</span> <span class="nav-text">2.3.6 Two&#39;s Complement Multiplication</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org93e7a1a"><span class="nav-number">1.3.3.7.</span> <span class="nav-text">2.3.7 Multiplying by Constants</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org079f43f"><span class="nav-number">1.3.3.8.</span> <span class="nav-text">2.3.8 Dividing by Powers of Two</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org7d7ce56"><span class="nav-number">1.3.3.9.</span> <span class="nav-text">2.3.9 Summary</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org10c36d6"><span class="nav-number">1.3.4.</span> <span class="nav-text">2.4 Floating Point</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#org37fafe8"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">2.4.1 Fractional Binary Numbers</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org4e9e454"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">2.4.2 IEEE Floating-Point Representation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#orgaa33d36"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">2.4.3 Rounding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org5e96b55"><span class="nav-number">1.3.4.4.</span> <span class="nav-text">2.4.4 Floating-Point Operations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org386e38b"><span class="nav-number">1.3.4.5.</span> <span class="nav-text">2.4.5 Floating Point in C</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#org31caf2e"><span class="nav-number">1.4.</span> <span class="nav-text">3 Q&amp;A in Machine-Level Representation of Programs</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#orgbe497ee"><span class="nav-number">1.4.1.</span> <span class="nav-text">3.1 What does the option -01 do in the following command line?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org8cec023"><span class="nav-number">1.4.2.</span> <span class="nav-text">3.2 What is ISA, and what does it do?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orge42b626"><span class="nav-number">1.4.3.</span> <span class="nav-text">3.3 Do you know which parts of the processor state are visible that normally hidden from the C programmer?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgf62fb71"><span class="nav-number">1.4.4.</span> <span class="nav-text">3.4 What do you see in the following picture?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org8e90df1"><span class="nav-number">1.4.5.</span> <span class="nav-text">3.5 What about this one?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org0adaeee"><span class="nav-number">1.4.6.</span> <span class="nav-text">3.6 Some important instructions!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org2be85e0"><span class="nav-number">1.4.7.</span> <span class="nav-text">3.7 Is there any restrictions when using data move instructions?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orge6badd4"><span class="nav-number">1.4.8.</span> <span class="nav-text">3.8 How can you copy a value from a small location to a larger location?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org66a6287"><span class="nav-number">1.4.9.</span> <span class="nav-text">3.9 How can you derive the bytes an instruction requires from its &#39;pattern&#39;?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgc0d8e1b"><span class="nav-number">1.4.10.</span> <span class="nav-text">3.10 Why bother push while you can use sub and mov?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org9c7e6c1"><span class="nav-number">1.4.11.</span> <span class="nav-text">3.11 What&#39;s wrong with the following code?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org8e3fac0"><span class="nav-number">1.4.12.</span> <span class="nav-text">3.12 What is the address of the mov instruction?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgb49468b"><span class="nav-number">1.4.13.</span> <span class="nav-text">3.13 What is the relationship between the annotation on the right and the byte coding on the left?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org36862ba"><span class="nav-number">1.4.14.</span> <span class="nav-text">3.14 What is the address of the jump target?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org3697abe"><span class="nav-number">1.4.15.</span> <span class="nav-text">3.15 Why the assembly code contains two conditional branches, even though the C code has only one if statement?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orge52ef63"><span class="nav-number">1.4.16.</span> <span class="nav-text">3.16 How the compilers generate loop code?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org4888d24"><span class="nav-number">1.4.17.</span> <span class="nav-text">3.17 Why can code based on conditional data transfer outperform code based on conditional control transfer?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org4deb9f0"><span class="nav-number">1.4.18.</span> <span class="nav-text">3.18 What&#39;s the differences between jmp, set and cmov ?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org3e55b4a"><span class="nav-number">1.4.19.</span> <span class="nav-text">3.19 What the peculiarities of  the conditional move are?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org5cb6f62"><span class="nav-number">1.4.20.</span> <span class="nav-text">3.20 How conditional operations can be implemented via conditional data transfers?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org31909a6"><span class="nav-number">1.4.21.</span> <span class="nav-text">3.21 Heads up: JUMP TABLE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org2a230b1"><span class="nav-number">1.4.22.</span> <span class="nav-text">3.22 Consider the following code and answer what the values are of the case labels in the `switch` statement body.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org667acd8"><span class="nav-number">1.4.23.</span> <span class="nav-text">3.23 Procedures</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#org943f78e"><span class="nav-number">1.4.23.1.</span> <span class="nav-text">3.23.1 So what is a stack frame structure?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#orga77ce9f"><span class="nav-number">1.4.23.2.</span> <span class="nav-text">3.23.2 Transferring control</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org0012665"><span class="nav-number">1.4.23.3.</span> <span class="nav-text">3.23.3 Some register usage conventions</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org8a8d44c"><span class="nav-number">1.4.23.4.</span> <span class="nav-text">3.23.4 Example codes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org9e58f9e"><span class="nav-number">1.4.23.5.</span> <span class="nav-text">3.23.5 Why does GCC allocate space that never gets used?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org4e67553"><span class="nav-number">1.4.23.6.</span> <span class="nav-text">3.23.6 Recursive procedures</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#orgd1063ce"><span class="nav-number">1.4.24.</span> <span class="nav-text">3.24 Array allocation and access</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org6916c6e"><span class="nav-number">1.4.25.</span> <span class="nav-text">3.25 Heterogeneous data structures</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#org3848815"><span class="nav-number">1.4.25.1.</span> <span class="nav-text">3.25.1 Why i has offset 4 in S3 rather than 1?</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org8d154e2"><span class="nav-number">1.4.26.</span> <span class="nav-text">3.26 What happend after buffer overflow?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org33bfd3e"><span class="nav-number">1.4.27.</span> <span class="nav-text">3.27 Three ways to thwart buffer overflow</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#orgb7670b5"><span class="nav-number">1.4.27.1.</span> <span class="nav-text">3.27.1 Stack randomization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#orgb3a14ec"><span class="nav-number">1.4.27.2.</span> <span class="nav-text">3.27.2 Stack corruption detection</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#org4303f8f"><span class="nav-number">1.4.27.3.</span> <span class="nav-text">3.27.3 Limiting executable code regions</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#org946827e"><span class="nav-number">1.4.28.</span> <span class="nav-text">3.28 Some of the key differences between IA32 and x86-64</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Powered by <a target="_blank" href="https://mengoreo.github.io">Mengoreo</a></span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: 'dbf596b8510d168b548e',
          clientSecret: 'c337db331a6264c5c3c6f848ee5ddd758126b97b',
          repo: 'mengoreo.github.com',
          owner: 'mengoreo',
          admin: ['mengoreo'],
          id: location.pathname,
	  perPage: 50,
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>



  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
